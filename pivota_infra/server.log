[2025-10-17 16:26:14,472] INFO - âœ… MCP router included
[2025-10-17 16:26:14,476] INFO - âœ… Operations router included
/Users/pengchydan/Desktop/Pivota Infra/Pivota-cursor-create-project-directory-structure-8344/pivota_infra/main.py:169: DeprecationWarning: 
        on_event is deprecated, use lifespan event handlers instead.

        Read more about it in the
        [FastAPI docs for Lifespan Events](https://fastapi.tiangolo.com/advanced/events/).
        
  @app.on_event("startup")
/Users/pengchydan/Desktop/Pivota Infra/Pivota-cursor-create-project-directory-structure-8344/pivota_infra/main.py:328: DeprecationWarning: 
        on_event is deprecated, use lifespan event handlers instead.

        Read more about it in the
        [FastAPI docs for Lifespan Events](https://fastapi.tiangolo.com/advanced/events/).
        
  @app.on_event("shutdown")
INFO:     Will watch for changes in these directories: ['/Users/pengchydan/Desktop/Pivota Infra/Pivota-cursor-create-project-directory-structure-8344/pivota_infra']
INFO:     Uvicorn running on http://0.0.0.0:8000 (Press CTRL+C to quit)
INFO:     Started reloader process [30053] using WatchFiles
[2025-10-17 16:26:15,551] INFO - âœ… MCP router included
[2025-10-17 16:26:15,555] INFO - âœ… Operations router included
[2025-10-17 16:26:15,733] INFO - âœ… MCP router included
[2025-10-17 16:26:15,737] INFO - âœ… Operations router included
INFO:     Started server process [30079]
INFO:     Waiting for application startup.
[2025-10-17 16:26:15,738] INFO - ğŸš€ Starting Pivota Infrastructure Dashboard...
[2025-10-17 16:26:15,738] INFO - ğŸ“¡ Connecting to database...
[2025-10-17 16:26:15,738] INFO -    Database URL type: <class 'databases.core.DatabaseURL'>
[2025-10-17 16:26:15,738] INFO -    Database driver: sqlite
[2025-10-17 16:26:15,738] INFO - âœ… Database connected successfully
[2025-10-17 16:26:15,738] INFO - âœ… Database connection test passed
[2025-10-17 16:26:15,738] INFO - ğŸ“‹ Creating tables...
[2025-10-17 16:26:15,759] INFO - âœ… Tables created:
[2025-10-17 16:26:15,759] INFO -    - Core: merchants, kyb_documents, merchant_onboarding, payment_router_config, orders
[2025-10-17 16:26:15,759] INFO -    - Cache: products_cache
[2025-10-17 16:26:15,759] INFO -    - Events: api_call_events, order_events
[2025-10-17 16:26:15,759] INFO -    - Analytics: merchant_analytics
[2025-10-17 16:26:15,759] INFO - ğŸ”„ Running database migrations...
[2025-10-17 16:26:15,760] INFO -    Checking for store_url column...
[2025-10-17 16:26:15,760] WARNING - âš ï¸ Migration warning (may be already applied): no such table: information_schema.columns
[2025-10-17 16:26:15,761] INFO - ğŸ”Œ Initializing optional services...
[2025-10-17 16:26:15,761] INFO - âœ… All services initialized successfully!
[2025-10-17 16:26:15,761] INFO - ğŸš€ Application startup complete!
[2025-10-17 16:26:15,761] INFO - ================================================================================
INFO:     Application startup complete.
INFO:     127.0.0.1:52138 - "GET /auth/admin-token HTTP/1.1" 200 OK
INFO:     127.0.0.1:52140 - "POST /orders/create HTTP/1.1" 404 Not Found
/Users/pengchydan/Library/Python/3.9/lib/python/site-packages/fastapi/openapi/utils.py:242: UserWarning: Duplicate Operation ID process_payment_api_payments_process_post for function process_payment at /Users/pengchydan/Desktop/Pivota Infra/Pivota-cursor-create-project-directory-structure-8344/pivota_infra/routes/payment_routes.py
  warnings.warn(message, stacklevel=1)
/Users/pengchydan/Library/Python/3.9/lib/python/site-packages/fastapi/openapi/utils.py:242: UserWarning: Duplicate Operation ID retry_payment_api_payments_retry_post for function retry_payment at /Users/pengchydan/Desktop/Pivota Infra/Pivota-cursor-create-project-directory-structure-8344/pivota_infra/routes/payment_routes.py
  warnings.warn(message, stacklevel=1)
/Users/pengchydan/Library/Python/3.9/lib/python/site-packages/fastapi/openapi/utils.py:242: UserWarning: Duplicate Operation ID get_payment_status_api_payments_status_get for function get_payment_status at /Users/pengchydan/Desktop/Pivota Infra/Pivota-cursor-create-project-directory-structure-8344/pivota_infra/routes/payment_routes.py
  warnings.warn(message, stacklevel=1)
/Users/pengchydan/Library/Python/3.9/lib/python/site-packages/fastapi/openapi/utils.py:242: UserWarning: Duplicate Operation ID get_available_psps_api_payments_psps_get for function get_available_psps at /Users/pengchydan/Desktop/Pivota Infra/Pivota-cursor-create-project-directory-structure-8344/pivota_infra/routes/payment_routes.py
  warnings.warn(message, stacklevel=1)
/Users/pengchydan/Library/Python/3.9/lib/python/site-packages/fastapi/openapi/utils.py:242: UserWarning: Duplicate Operation ID get_order_payment_status_api_payments_orders__order_id__get for function get_order_payment_status at /Users/pengchydan/Desktop/Pivota Infra/Pivota-cursor-create-project-directory-structure-8344/pivota_infra/routes/payment_routes.py
  warnings.warn(message, stacklevel=1)
INFO:     127.0.0.1:52184 - "GET /openapi.json HTTP/1.1" 200 OK
INFO:     127.0.0.1:52244 - "GET /auth/admin-token HTTP/1.1" 200 OK
INFO:     127.0.0.1:52246 - "POST /orders/create HTTP/1.1" 404 Not Found
INFO:     127.0.0.1:52307 - "GET /auth/admin-token HTTP/1.1" 200 OK
INFO:     127.0.0.1:52309 - "GET /merchant/onboarding/all HTTP/1.1" 200 OK
ğŸ” Starting auto-KYB pre-approval validation...
âœ… auto_kyb_validator imported successfully
âœ… Auto-KYB validation completed: {'approved': True, 'confidence_score': 0.96, 'validation_results': {'url_validation': {'valid': True, 'message': 'Known e-commerce platform detected: chydantest.myshopify.com'}, 'name_match': {'match': True, 'message': 'Trusted platform auto-approval', 'score': 0.9}}, 'requires_full_kyb': True, 'full_kyb_deadline': '2025-10-24T08:27:35.223965'}
âœ… Merchant created: merch_6b90dc9838d5fd9c
ğŸ‰ Auto-approving merchant merch_6b90dc9838d5fd9c...
âœ… Merchant merch_6b90dc9838d5fd9c auto-approved successfully
INFO:     127.0.0.1:52348 - "POST /merchant/onboarding/register HTTP/1.1" 200 OK
INFO:     127.0.0.1:52390 - "POST /merchant/onboarding/psp/setup HTTP/1.1" 422 Unprocessable Entity
ğŸ” Validating stripe credentials...
ğŸ” Validating Stripe key via HTTP: sk_test_123456789012...
ğŸ”’ Stripe key invalid (status=401)
âŒ PSP validation failed: Invalid Stripe API key. Please check your key and try again.
INFO:     127.0.0.1:52432 - "POST /merchant/onboarding/psp/setup HTTP/1.1" 400 Bad Request
ğŸ” Validating stripe credentials...
ğŸ” Validating Stripe key via HTTP: sk_test_51HQvZFLqxXz...
ğŸ”’ Stripe key invalid (status=401)
âŒ PSP validation failed: Invalid Stripe API key. Please check your key and try again.
INFO:     127.0.0.1:52485 - "POST /merchant/onboarding/psp/setup HTTP/1.1" 400 Bad Request
INFO:     127.0.0.1:53229 - "GET /health HTTP/1.1" 200 OK
INFO:     127.0.0.1:53336 - "POST /merchant/onboarding/register HTTP/1.1" 500 Internal Server Error
INFO:     127.0.0.1:53386 - "POST /merchant/onboarding/register HTTP/1.1" 500 Internal Server Error
INFO:     127.0.0.1:53448 - "GET /auth/admin-token HTTP/1.1" 200 OK
INFO:     127.0.0.1:53450 - "GET /merchant/onboarding/all HTTP/1.1" 403 Forbidden
INFO:     127.0.0.1:53505 - "GET /auth/admin-token HTTP/1.1" 200 OK
INFO:     127.0.0.1:53507 - "GET /merchant/onboarding/all HTTP/1.1" 200 OK
WARNING:  WatchFiles detected changes in 'routes/merchant_onboarding_routes.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
[2025-10-17 16:30:38,931] INFO - Database disconnected
[2025-10-17 16:30:38,931] INFO - ğŸ›‘ Application shutdown complete
INFO:     Application shutdown complete.
INFO:     Finished server process [30079]
[2025-10-17 16:30:40,227] INFO - âœ… MCP router included
[2025-10-17 16:30:40,230] INFO - âœ… Operations router included
[2025-10-17 16:30:40,286] INFO - âœ… MCP router included
[2025-10-17 16:30:40,290] INFO - âœ… Operations router included
INFO:     Started server process [30678]
INFO:     Waiting for application startup.
[2025-10-17 16:30:40,291] INFO - ğŸš€ Starting Pivota Infrastructure Dashboard...
[2025-10-17 16:30:40,291] INFO - ğŸ“¡ Connecting to database...
[2025-10-17 16:30:40,291] INFO -    Database URL type: <class 'databases.core.DatabaseURL'>
[2025-10-17 16:30:40,291] INFO -    Database driver: sqlite
[2025-10-17 16:30:40,291] INFO - âœ… Database connected successfully
[2025-10-17 16:30:40,291] INFO - âœ… Database connection test passed
[2025-10-17 16:30:40,291] INFO - ğŸ“‹ Creating tables...
[2025-10-17 16:30:40,292] INFO - âœ… Tables created:
[2025-10-17 16:30:40,292] INFO -    - Core: merchants, kyb_documents, merchant_onboarding, payment_router_config, orders
[2025-10-17 16:30:40,292] INFO -    - Cache: products_cache
[2025-10-17 16:30:40,292] INFO -    - Events: api_call_events, order_events
[2025-10-17 16:30:40,292] INFO -    - Analytics: merchant_analytics
[2025-10-17 16:30:40,292] INFO - ğŸ”„ Running database migrations...
[2025-10-17 16:30:40,292] INFO -    Checking for store_url column...
[2025-10-17 16:30:40,293] WARNING - âš ï¸ Migration warning (may be already applied): no such table: information_schema.columns
[2025-10-17 16:30:40,293] INFO - ğŸ”Œ Initializing optional services...
[2025-10-17 16:30:40,293] INFO - âœ… All services initialized successfully!
[2025-10-17 16:30:40,293] INFO - ğŸš€ Application startup complete!
[2025-10-17 16:30:40,293] INFO - ================================================================================
INFO:     Application startup complete.
WARNING:  WatchFiles detected changes in 'routes/merchant_onboarding_routes.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
[2025-10-17 16:30:58,082] INFO - Database disconnected
[2025-10-17 16:30:58,082] INFO - ğŸ›‘ Application shutdown complete
INFO:     Application shutdown complete.
INFO:     Finished server process [30678]
[2025-10-17 16:30:59,350] INFO - âœ… MCP router included
[2025-10-17 16:30:59,354] INFO - âœ… Operations router included
[2025-10-17 16:30:59,417] INFO - âœ… MCP router included
[2025-10-17 16:30:59,421] INFO - âœ… Operations router included
INFO:     Started server process [30740]
INFO:     Waiting for application startup.
[2025-10-17 16:30:59,422] INFO - ğŸš€ Starting Pivota Infrastructure Dashboard...
[2025-10-17 16:30:59,422] INFO - ğŸ“¡ Connecting to database...
[2025-10-17 16:30:59,422] INFO -    Database URL type: <class 'databases.core.DatabaseURL'>
[2025-10-17 16:30:59,422] INFO -    Database driver: sqlite
[2025-10-17 16:30:59,422] INFO - âœ… Database connected successfully
[2025-10-17 16:30:59,423] INFO - âœ… Database connection test passed
[2025-10-17 16:30:59,423] INFO - ğŸ“‹ Creating tables...
[2025-10-17 16:30:59,424] INFO - âœ… Tables created:
[2025-10-17 16:30:59,424] INFO -    - Core: merchants, kyb_documents, merchant_onboarding, payment_router_config, orders
[2025-10-17 16:30:59,424] INFO -    - Cache: products_cache
[2025-10-17 16:30:59,424] INFO -    - Events: api_call_events, order_events
[2025-10-17 16:30:59,424] INFO -    - Analytics: merchant_analytics
[2025-10-17 16:30:59,424] INFO - ğŸ”„ Running database migrations...
[2025-10-17 16:30:59,424] INFO -    Checking for store_url column...
[2025-10-17 16:30:59,424] WARNING - âš ï¸ Migration warning (may be already applied): no such table: information_schema.columns
[2025-10-17 16:30:59,424] INFO - ğŸ”Œ Initializing optional services...
[2025-10-17 16:30:59,424] INFO - âœ… All services initialized successfully!
[2025-10-17 16:30:59,424] INFO - ğŸš€ Application startup complete!
[2025-10-17 16:30:59,424] INFO - ================================================================================
INFO:     Application startup complete.
WARNING:  WatchFiles detected changes in 'routes/order_routes.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
[2025-10-17 16:38:23,157] INFO - Database disconnected
[2025-10-17 16:38:23,157] INFO - ğŸ›‘ Application shutdown complete
INFO:     Application shutdown complete.
INFO:     Finished server process [30740]
[2025-10-17 16:38:24,334] INFO - âœ… MCP router included
[2025-10-17 16:38:24,338] INFO - âœ… Operations router included
[2025-10-17 16:38:24,392] INFO - âœ… MCP router included
[2025-10-17 16:38:24,395] INFO - âœ… Operations router included
INFO:     Started server process [31026]
INFO:     Waiting for application startup.
[2025-10-17 16:38:24,396] INFO - ğŸš€ Starting Pivota Infrastructure Dashboard...
[2025-10-17 16:38:24,396] INFO - ğŸ“¡ Connecting to database...
[2025-10-17 16:38:24,396] INFO -    Database URL type: <class 'databases.core.DatabaseURL'>
[2025-10-17 16:38:24,396] INFO -    Database driver: sqlite
[2025-10-17 16:38:24,396] INFO - âœ… Database connected successfully
[2025-10-17 16:38:24,397] INFO - âœ… Database connection test passed
[2025-10-17 16:38:24,397] INFO - ğŸ“‹ Creating tables...
[2025-10-17 16:38:24,397] INFO - âœ… Tables created:
[2025-10-17 16:38:24,397] INFO -    - Core: merchants, kyb_documents, merchant_onboarding, payment_router_config, orders
[2025-10-17 16:38:24,397] INFO -    - Cache: products_cache
[2025-10-17 16:38:24,397] INFO -    - Events: api_call_events, order_events
[2025-10-17 16:38:24,397] INFO -    - Analytics: merchant_analytics
[2025-10-17 16:38:24,397] INFO - ğŸ”„ Running database migrations...
[2025-10-17 16:38:24,397] INFO -    Checking for store_url column...
[2025-10-17 16:38:24,398] WARNING - âš ï¸ Migration warning (may be already applied): no such table: information_schema.columns
[2025-10-17 16:38:24,398] INFO - ğŸ”Œ Initializing optional services...
[2025-10-17 16:38:24,398] INFO - âœ… All services initialized successfully!
[2025-10-17 16:38:24,398] INFO - ğŸš€ Application startup complete!
[2025-10-17 16:38:24,398] INFO - ================================================================================
INFO:     Application startup complete.
WARNING:  WatchFiles detected changes in 'routes/order_routes.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
[2025-10-17 16:38:33,900] INFO - Database disconnected
[2025-10-17 16:38:33,900] INFO - ğŸ›‘ Application shutdown complete
INFO:     Application shutdown complete.
INFO:     Finished server process [31026]
[2025-10-17 16:38:35,136] INFO - âœ… MCP router included
[2025-10-17 16:38:35,140] INFO - âœ… Operations router included
[2025-10-17 16:38:35,195] INFO - âœ… MCP router included
[2025-10-17 16:38:35,199] INFO - âœ… Operations router included
INFO:     Started server process [31032]
INFO:     Waiting for application startup.
[2025-10-17 16:38:35,199] INFO - ğŸš€ Starting Pivota Infrastructure Dashboard...
[2025-10-17 16:38:35,199] INFO - ğŸ“¡ Connecting to database...
[2025-10-17 16:38:35,199] INFO -    Database URL type: <class 'databases.core.DatabaseURL'>
[2025-10-17 16:38:35,200] INFO -    Database driver: sqlite
[2025-10-17 16:38:35,200] INFO - âœ… Database connected successfully
[2025-10-17 16:38:35,200] INFO - âœ… Database connection test passed
[2025-10-17 16:38:35,200] INFO - ğŸ“‹ Creating tables...
[2025-10-17 16:38:35,201] INFO - âœ… Tables created:
[2025-10-17 16:38:35,201] INFO -    - Core: merchants, kyb_documents, merchant_onboarding, payment_router_config, orders
[2025-10-17 16:38:35,201] INFO -    - Cache: products_cache
[2025-10-17 16:38:35,201] INFO -    - Events: api_call_events, order_events
[2025-10-17 16:38:35,201] INFO -    - Analytics: merchant_analytics
[2025-10-17 16:38:35,201] INFO - ğŸ”„ Running database migrations...
[2025-10-17 16:38:35,201] INFO -    Checking for store_url column...
[2025-10-17 16:38:35,201] WARNING - âš ï¸ Migration warning (may be already applied): no such table: information_schema.columns
[2025-10-17 16:38:35,201] INFO - ğŸ”Œ Initializing optional services...
[2025-10-17 16:38:35,201] INFO - âœ… All services initialized successfully!
[2025-10-17 16:38:35,202] INFO - ğŸš€ Application startup complete!
[2025-10-17 16:38:35,202] INFO - ================================================================================
INFO:     Application startup complete.
WARNING:  WatchFiles detected changes in 'models/order.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
[2025-10-17 16:50:53,806] INFO - Database disconnected
[2025-10-17 16:50:53,807] INFO - ğŸ›‘ Application shutdown complete
INFO:     Application shutdown complete.
INFO:     Finished server process [31032]
[2025-10-17 16:50:55,241] INFO - âœ… MCP router included
[2025-10-17 16:50:55,244] INFO - âœ… Operations router included
[2025-10-17 16:50:55,304] INFO - âœ… MCP router included
[2025-10-17 16:50:55,308] INFO - âœ… Operations router included
INFO:     Started server process [31246]
INFO:     Waiting for application startup.
[2025-10-17 16:50:55,309] INFO - ğŸš€ Starting Pivota Infrastructure Dashboard...
[2025-10-17 16:50:55,309] INFO - ğŸ“¡ Connecting to database...
[2025-10-17 16:50:55,309] INFO -    Database URL type: <class 'databases.core.DatabaseURL'>
[2025-10-17 16:50:55,309] INFO -    Database driver: sqlite
[2025-10-17 16:50:55,309] INFO - âœ… Database connected successfully
[2025-10-17 16:50:55,310] INFO - âœ… Database connection test passed
[2025-10-17 16:50:55,310] INFO - ğŸ“‹ Creating tables...
[2025-10-17 16:50:55,310] INFO - âœ… Tables created:
[2025-10-17 16:50:55,310] INFO -    - Core: merchants, kyb_documents, merchant_onboarding, payment_router_config, orders
[2025-10-17 16:50:55,310] INFO -    - Cache: products_cache
[2025-10-17 16:50:55,311] INFO -    - Events: api_call_events, order_events
[2025-10-17 16:50:55,311] INFO -    - Analytics: merchant_analytics
[2025-10-17 16:50:55,311] INFO - ğŸ”„ Running database migrations...
[2025-10-17 16:50:55,311] INFO -    Checking for store_url column...
[2025-10-17 16:50:55,311] WARNING - âš ï¸ Migration warning (may be already applied): no such table: information_schema.columns
[2025-10-17 16:50:55,311] INFO - ğŸ”Œ Initializing optional services...
[2025-10-17 16:50:55,311] INFO - âœ… All services initialized successfully!
[2025-10-17 16:50:55,311] INFO - ğŸš€ Application startup complete!
[2025-10-17 16:50:55,311] INFO - ================================================================================
INFO:     Application startup complete.
WARNING:  WatchFiles detected changes in 'models/order.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
[2025-10-17 16:51:16,430] INFO - Database disconnected
[2025-10-17 16:51:16,430] INFO - ğŸ›‘ Application shutdown complete
INFO:     Application shutdown complete.
INFO:     Finished server process [31246]
[2025-10-17 16:51:18,017] INFO - âœ… MCP router included
[2025-10-17 16:51:18,021] INFO - âœ… Operations router included
[2025-10-17 16:51:18,090] INFO - âœ… MCP router included
[2025-10-17 16:51:18,093] INFO - âœ… Operations router included
INFO:     Started server process [31248]
INFO:     Waiting for application startup.
[2025-10-17 16:51:18,095] INFO - ğŸš€ Starting Pivota Infrastructure Dashboard...
[2025-10-17 16:51:18,095] INFO - ğŸ“¡ Connecting to database...
[2025-10-17 16:51:18,095] INFO -    Database URL type: <class 'databases.core.DatabaseURL'>
[2025-10-17 16:51:18,095] INFO -    Database driver: sqlite
[2025-10-17 16:51:18,095] INFO - âœ… Database connected successfully
[2025-10-17 16:51:18,095] INFO - âœ… Database connection test passed
[2025-10-17 16:51:18,095] INFO - ğŸ“‹ Creating tables...
[2025-10-17 16:51:18,096] INFO - âœ… Tables created:
[2025-10-17 16:51:18,096] INFO -    - Core: merchants, kyb_documents, merchant_onboarding, payment_router_config, orders
[2025-10-17 16:51:18,096] INFO -    - Cache: products_cache
[2025-10-17 16:51:18,096] INFO -    - Events: api_call_events, order_events
[2025-10-17 16:51:18,096] INFO -    - Analytics: merchant_analytics
[2025-10-17 16:51:18,096] INFO - ğŸ”„ Running database migrations...
[2025-10-17 16:51:18,096] INFO -    Checking for store_url column...
[2025-10-17 16:51:18,097] WARNING - âš ï¸ Migration warning (may be already applied): no such table: information_schema.columns
[2025-10-17 16:51:18,097] INFO - ğŸ”Œ Initializing optional services...
[2025-10-17 16:51:18,097] INFO - âœ… All services initialized successfully!
[2025-10-17 16:51:18,097] INFO - ğŸš€ Application startup complete!
[2025-10-17 16:51:18,097] INFO - ================================================================================
INFO:     Application startup complete.
WARNING:  WatchFiles detected changes in 'routes/order_routes.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
[2025-10-17 16:51:28,617] INFO - Database disconnected
[2025-10-17 16:51:28,617] INFO - ğŸ›‘ Application shutdown complete
INFO:     Application shutdown complete.
INFO:     Finished server process [31248]
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/multiprocessing/spawn.py", line 116, in spawn_main
    exitcode = _main(fd, parent_sentinel)
  File "/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/multiprocessing/spawn.py", line 125, in _main
    prepare(preparation_data)
  File "/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/multiprocessing/spawn.py", line 236, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/multiprocessing/spawn.py", line 287, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
  File "/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/runpy.py", line 268, in run_path
    return _run_module_code(code, init_globals, run_name,
  File "/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/runpy.py", line 97, in _run_module_code
    _run_code(code, mod_globals, init_globals,
  File "/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/runpy.py", line 87, in _run_code
    exec(code, run_globals)
  File "/Users/pengchydan/Desktop/Pivota Infra/Pivota-cursor-create-project-directory-structure-8344/pivota_infra/main.py", line 41, in <module>
    from routes.order_routes import router as order_router
  File "/Users/pengchydan/Desktop/Pivota Infra/Pivota-cursor-create-project-directory-structure-8344/pivota_infra/routes/order_routes.py", line 39, in <module>
    ) -> Tuple[bool, Dict[str, Any]]:
NameError: name 'Tuple' is not defined
WARNING:  WatchFiles detected changes in 'routes/order_routes.py'. Reloading...
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/multiprocessing/spawn.py", line 116, in spawn_main
    exitcode = _main(fd, parent_sentinel)
  File "/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/multiprocessing/spawn.py", line 125, in _main
    prepare(preparation_data)
  File "/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/multiprocessing/spawn.py", line 236, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/multiprocessing/spawn.py", line 287, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
  File "/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/runpy.py", line 268, in run_path
    return _run_module_code(code, init_globals, run_name,
  File "/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/runpy.py", line 97, in _run_module_code
    _run_code(code, mod_globals, init_globals,
  File "/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/runpy.py", line 87, in _run_code
    exec(code, run_globals)
  File "/Users/pengchydan/Desktop/Pivota Infra/Pivota-cursor-create-project-directory-structure-8344/pivota_infra/main.py", line 41, in <module>
    from routes.order_routes import router as order_router
  File "/Users/pengchydan/Desktop/Pivota Infra/Pivota-cursor-create-project-directory-structure-8344/pivota_infra/routes/order_routes.py", line 39, in <module>
    ) -> Tuple[bool, Dict[str, Any]]:
NameError: name 'Tuple' is not defined
WARNING:  WatchFiles detected changes in 'routes/order_routes.py'. Reloading...
[2025-10-17 16:52:01,792] INFO - âœ… MCP router included
[2025-10-17 16:52:01,796] INFO - âœ… Operations router included
[2025-10-17 16:52:01,855] INFO - âœ… MCP router included
[2025-10-17 16:52:01,858] INFO - âœ… Operations router included
INFO:     Started server process [31290]
INFO:     Waiting for application startup.
[2025-10-17 16:52:01,859] INFO - ğŸš€ Starting Pivota Infrastructure Dashboard...
[2025-10-17 16:52:01,859] INFO - ğŸ“¡ Connecting to database...
[2025-10-17 16:52:01,859] INFO -    Database URL type: <class 'databases.core.DatabaseURL'>
[2025-10-17 16:52:01,859] INFO -    Database driver: sqlite
[2025-10-17 16:52:01,859] INFO - âœ… Database connected successfully
[2025-10-17 16:52:01,860] INFO - âœ… Database connection test passed
[2025-10-17 16:52:01,860] INFO - ğŸ“‹ Creating tables...
[2025-10-17 16:52:01,861] INFO - âœ… Tables created:
[2025-10-17 16:52:01,861] INFO -    - Core: merchants, kyb_documents, merchant_onboarding, payment_router_config, orders
[2025-10-17 16:52:01,861] INFO -    - Cache: products_cache
[2025-10-17 16:52:01,861] INFO -    - Events: api_call_events, order_events
[2025-10-17 16:52:01,861] INFO -    - Analytics: merchant_analytics
[2025-10-17 16:52:01,861] INFO - ğŸ”„ Running database migrations...
[2025-10-17 16:52:01,861] INFO -    Checking for store_url column...
[2025-10-17 16:52:01,861] WARNING - âš ï¸ Migration warning (may be already applied): no such table: information_schema.columns
[2025-10-17 16:52:01,861] INFO - ğŸ”Œ Initializing optional services...
[2025-10-17 16:52:01,862] INFO - âœ… All services initialized successfully!
[2025-10-17 16:52:01,862] INFO - ğŸš€ Application startup complete!
[2025-10-17 16:52:01,862] INFO - ================================================================================
INFO:     Application startup complete.
WARNING:  WatchFiles detected changes in 'routes/order_routes.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
[2025-10-17 16:52:16,144] INFO - Database disconnected
[2025-10-17 16:52:16,144] INFO - ğŸ›‘ Application shutdown complete
INFO:     Application shutdown complete.
INFO:     Finished server process [31290]
[2025-10-17 16:52:17,499] INFO - âœ… MCP router included
[2025-10-17 16:52:17,502] INFO - âœ… Operations router included
[2025-10-17 16:52:17,559] INFO - âœ… MCP router included
[2025-10-17 16:52:17,563] INFO - âœ… Operations router included
INFO:     Started server process [31296]
INFO:     Waiting for application startup.
[2025-10-17 16:52:17,564] INFO - ğŸš€ Starting Pivota Infrastructure Dashboard...
[2025-10-17 16:52:17,564] INFO - ğŸ“¡ Connecting to database...
[2025-10-17 16:52:17,564] INFO -    Database URL type: <class 'databases.core.DatabaseURL'>
[2025-10-17 16:52:17,564] INFO -    Database driver: sqlite
[2025-10-17 16:52:17,564] INFO - âœ… Database connected successfully
[2025-10-17 16:52:17,565] INFO - âœ… Database connection test passed
[2025-10-17 16:52:17,566] INFO - ğŸ“‹ Creating tables...
[2025-10-17 16:52:17,567] INFO - âœ… Tables created:
[2025-10-17 16:52:17,567] INFO -    - Core: merchants, kyb_documents, merchant_onboarding, payment_router_config, orders
[2025-10-17 16:52:17,567] INFO -    - Cache: products_cache
[2025-10-17 16:52:17,567] INFO -    - Events: api_call_events, order_events
[2025-10-17 16:52:17,567] INFO -    - Analytics: merchant_analytics
[2025-10-17 16:52:17,567] INFO - ğŸ”„ Running database migrations...
[2025-10-17 16:52:17,567] INFO -    Checking for store_url column...
[2025-10-17 16:52:17,568] WARNING - âš ï¸ Migration warning (may be already applied): no such table: information_schema.columns
[2025-10-17 16:52:17,568] INFO - ğŸ”Œ Initializing optional services...
[2025-10-17 16:52:17,568] INFO - âœ… All services initialized successfully!
[2025-10-17 16:52:17,568] INFO - ğŸš€ Application startup complete!
[2025-10-17 16:52:17,568] INFO - ================================================================================
INFO:     Application startup complete.
WARNING:  WatchFiles detected changes in 'routes/order_routes.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
[2025-10-17 16:52:33,056] INFO - Database disconnected
[2025-10-17 16:52:33,056] INFO - ğŸ›‘ Application shutdown complete
INFO:     Application shutdown complete.
INFO:     Finished server process [31296]
[2025-10-17 16:52:34,424] INFO - âœ… MCP router included
[2025-10-17 16:52:34,428] INFO - âœ… Operations router included
[2025-10-17 16:52:34,492] INFO - âœ… MCP router included
[2025-10-17 16:52:34,496] INFO - âœ… Operations router included
INFO:     Started server process [31303]
INFO:     Waiting for application startup.
[2025-10-17 16:52:34,497] INFO - ğŸš€ Starting Pivota Infrastructure Dashboard...
[2025-10-17 16:52:34,497] INFO - ğŸ“¡ Connecting to database...
[2025-10-17 16:52:34,497] INFO -    Database URL type: <class 'databases.core.DatabaseURL'>
[2025-10-17 16:52:34,497] INFO -    Database driver: sqlite
[2025-10-17 16:52:34,497] INFO - âœ… Database connected successfully
[2025-10-17 16:52:34,498] INFO - âœ… Database connection test passed
[2025-10-17 16:52:34,498] INFO - ğŸ“‹ Creating tables...
[2025-10-17 16:52:34,499] INFO - âœ… Tables created:
[2025-10-17 16:52:34,499] INFO -    - Core: merchants, kyb_documents, merchant_onboarding, payment_router_config, orders
[2025-10-17 16:52:34,499] INFO -    - Cache: products_cache
[2025-10-17 16:52:34,499] INFO -    - Events: api_call_events, order_events
[2025-10-17 16:52:34,499] INFO -    - Analytics: merchant_analytics
[2025-10-17 16:52:34,499] INFO - ğŸ”„ Running database migrations...
[2025-10-17 16:52:34,499] INFO -    Checking for store_url column...
[2025-10-17 16:52:34,499] WARNING - âš ï¸ Migration warning (may be already applied): no such table: information_schema.columns
[2025-10-17 16:52:34,500] INFO - ğŸ”Œ Initializing optional services...
[2025-10-17 16:52:34,500] INFO - âœ… All services initialized successfully!
[2025-10-17 16:52:34,500] INFO - ğŸš€ Application startup complete!
[2025-10-17 16:52:34,500] INFO - ================================================================================
INFO:     Application startup complete.
WARNING:  WatchFiles detected changes in 'routes/order_routes.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
[2025-10-17 16:52:39,654] INFO - Database disconnected
[2025-10-17 16:52:39,654] INFO - ğŸ›‘ Application shutdown complete
INFO:     Application shutdown complete.
INFO:     Finished server process [31303]
WARNING:  WatchFiles detected changes in 'routes/order_routes.py'. Reloading...
[2025-10-17 16:52:41,129] INFO - âœ… MCP router included
[2025-10-17 16:52:41,133] INFO - âœ… Operations router included
[2025-10-17 16:52:41,187] INFO - âœ… MCP router included
[2025-10-17 16:52:41,190] INFO - âœ… Operations router included
INFO:     Started server process [31312]
INFO:     Waiting for application startup.
[2025-10-17 16:52:41,191] INFO - ğŸš€ Starting Pivota Infrastructure Dashboard...
[2025-10-17 16:52:41,191] INFO - ğŸ“¡ Connecting to database...
[2025-10-17 16:52:41,191] INFO -    Database URL type: <class 'databases.core.DatabaseURL'>
[2025-10-17 16:52:41,191] INFO -    Database driver: sqlite
[2025-10-17 16:52:41,191] INFO - âœ… Database connected successfully
[2025-10-17 16:52:41,192] INFO - âœ… Database connection test passed
[2025-10-17 16:52:41,192] INFO - ğŸ“‹ Creating tables...
[2025-10-17 16:52:41,192] INFO - âœ… Tables created:
[2025-10-17 16:52:41,192] INFO -    - Core: merchants, kyb_documents, merchant_onboarding, payment_router_config, orders
[2025-10-17 16:52:41,192] INFO -    - Cache: products_cache
[2025-10-17 16:52:41,193] INFO -    - Events: api_call_events, order_events
[2025-10-17 16:52:41,193] INFO -    - Analytics: merchant_analytics
[2025-10-17 16:52:41,193] INFO - ğŸ”„ Running database migrations...
[2025-10-17 16:52:41,193] INFO -    Checking for store_url column...
[2025-10-17 16:52:41,193] WARNING - âš ï¸ Migration warning (may be already applied): no such table: information_schema.columns
[2025-10-17 16:52:41,193] INFO - ğŸ”Œ Initializing optional services...
[2025-10-17 16:52:41,193] INFO - âœ… All services initialized successfully!
[2025-10-17 16:52:41,193] INFO - ğŸš€ Application startup complete!
[2025-10-17 16:52:41,193] INFO - ================================================================================
INFO:     Application startup complete.
WARNING:  WatchFiles detected changes in 'routes/order_routes.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
[2025-10-17 16:52:51,100] INFO - Database disconnected
[2025-10-17 16:52:51,100] INFO - ğŸ›‘ Application shutdown complete
INFO:     Application shutdown complete.
INFO:     Finished server process [31312]
WARNING:  WatchFiles detected changes in 'routes/order_routes.py'. Reloading...
WARNING:  WatchFiles detected changes in 'routes/order_routes.py'. Reloading...
[2025-10-17 16:52:53,288] INFO - âœ… MCP router included
[2025-10-17 16:52:53,291] INFO - âœ… Operations router included
[2025-10-17 16:52:53,346] INFO - âœ… MCP router included
[2025-10-17 16:52:53,349] INFO - âœ… Operations router included
INFO:     Started server process [31324]
INFO:     Waiting for application startup.
[2025-10-17 16:52:53,350] INFO - ğŸš€ Starting Pivota Infrastructure Dashboard...
[2025-10-17 16:52:53,350] INFO - ğŸ“¡ Connecting to database...
[2025-10-17 16:52:53,350] INFO -    Database URL type: <class 'databases.core.DatabaseURL'>
[2025-10-17 16:52:53,351] INFO -    Database driver: sqlite
[2025-10-17 16:52:53,351] INFO - âœ… Database connected successfully
[2025-10-17 16:52:53,351] INFO - âœ… Database connection test passed
[2025-10-17 16:52:53,351] INFO - ğŸ“‹ Creating tables...
[2025-10-17 16:52:53,352] INFO - âœ… Tables created:
[2025-10-17 16:52:53,352] INFO -    - Core: merchants, kyb_documents, merchant_onboarding, payment_router_config, orders
[2025-10-17 16:52:53,352] INFO -    - Cache: products_cache
[2025-10-17 16:52:53,352] INFO -    - Events: api_call_events, order_events
[2025-10-17 16:52:53,352] INFO -    - Analytics: merchant_analytics
[2025-10-17 16:52:53,352] INFO - ğŸ”„ Running database migrations...
[2025-10-17 16:52:53,352] INFO -    Checking for store_url column...
[2025-10-17 16:52:53,353] WARNING - âš ï¸ Migration warning (may be already applied): no such table: information_schema.columns
[2025-10-17 16:52:53,353] INFO - ğŸ”Œ Initializing optional services...
[2025-10-17 16:52:53,353] INFO - âœ… All services initialized successfully!
[2025-10-17 16:52:53,353] INFO - ğŸš€ Application startup complete!
[2025-10-17 16:52:53,353] INFO - ================================================================================
INFO:     Application startup complete.
WARNING:  WatchFiles detected changes in 'routes/order_routes.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
[2025-10-17 16:53:03,159] INFO - Database disconnected
[2025-10-17 16:53:03,159] INFO - ğŸ›‘ Application shutdown complete
INFO:     Application shutdown complete.
INFO:     Finished server process [31324]
[2025-10-17 16:53:04,396] INFO - âœ… MCP router included
[2025-10-17 16:53:04,400] INFO - âœ… Operations router included
[2025-10-17 16:53:04,455] INFO - âœ… MCP router included
[2025-10-17 16:53:04,458] INFO - âœ… Operations router included
INFO:     Started server process [31334]
INFO:     Waiting for application startup.
[2025-10-17 16:53:04,459] INFO - ğŸš€ Starting Pivota Infrastructure Dashboard...
[2025-10-17 16:53:04,459] INFO - ğŸ“¡ Connecting to database...
[2025-10-17 16:53:04,459] INFO -    Database URL type: <class 'databases.core.DatabaseURL'>
[2025-10-17 16:53:04,459] INFO -    Database driver: sqlite
[2025-10-17 16:53:04,459] INFO - âœ… Database connected successfully
[2025-10-17 16:53:04,460] INFO - âœ… Database connection test passed
[2025-10-17 16:53:04,460] INFO - ğŸ“‹ Creating tables...
[2025-10-17 16:53:04,460] INFO - âœ… Tables created:
[2025-10-17 16:53:04,460] INFO -    - Core: merchants, kyb_documents, merchant_onboarding, payment_router_config, orders
[2025-10-17 16:53:04,461] INFO -    - Cache: products_cache
[2025-10-17 16:53:04,461] INFO -    - Events: api_call_events, order_events
[2025-10-17 16:53:04,461] INFO -    - Analytics: merchant_analytics
[2025-10-17 16:53:04,461] INFO - ğŸ”„ Running database migrations...
[2025-10-17 16:53:04,461] INFO -    Checking for store_url column...
[2025-10-17 16:53:04,461] WARNING - âš ï¸ Migration warning (may be already applied): no such table: information_schema.columns
[2025-10-17 16:53:04,461] INFO - ğŸ”Œ Initializing optional services...
[2025-10-17 16:53:04,461] INFO - âœ… All services initialized successfully!
[2025-10-17 16:53:04,461] INFO - ğŸš€ Application startup complete!
[2025-10-17 16:53:04,461] INFO - ================================================================================
INFO:     Application startup complete.
WARNING:  WatchFiles detected changes in 'routes/order_routes.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
[2025-10-17 16:53:15,277] INFO - Database disconnected
[2025-10-17 16:53:15,277] INFO - ğŸ›‘ Application shutdown complete
INFO:     Application shutdown complete.
INFO:     Finished server process [31334]
[2025-10-17 16:53:16,438] INFO - âœ… MCP router included
[2025-10-17 16:53:16,442] INFO - âœ… Operations router included
[2025-10-17 16:53:16,500] INFO - âœ… MCP router included
[2025-10-17 16:53:16,504] INFO - âœ… Operations router included
INFO:     Started server process [31362]
INFO:     Waiting for application startup.
[2025-10-17 16:53:16,505] INFO - ğŸš€ Starting Pivota Infrastructure Dashboard...
[2025-10-17 16:53:16,505] INFO - ğŸ“¡ Connecting to database...
[2025-10-17 16:53:16,505] INFO -    Database URL type: <class 'databases.core.DatabaseURL'>
[2025-10-17 16:53:16,505] INFO -    Database driver: sqlite
[2025-10-17 16:53:16,505] INFO - âœ… Database connected successfully
[2025-10-17 16:53:16,505] INFO - âœ… Database connection test passed
[2025-10-17 16:53:16,505] INFO - ğŸ“‹ Creating tables...
[2025-10-17 16:53:16,506] INFO - âœ… Tables created:
[2025-10-17 16:53:16,506] INFO -    - Core: merchants, kyb_documents, merchant_onboarding, payment_router_config, orders
[2025-10-17 16:53:16,506] INFO -    - Cache: products_cache
[2025-10-17 16:53:16,506] INFO -    - Events: api_call_events, order_events
[2025-10-17 16:53:16,506] INFO -    - Analytics: merchant_analytics
[2025-10-17 16:53:16,506] INFO - ğŸ”„ Running database migrations...
[2025-10-17 16:53:16,506] INFO -    Checking for store_url column...
[2025-10-17 16:53:16,507] WARNING - âš ï¸ Migration warning (may be already applied): no such table: information_schema.columns
[2025-10-17 16:53:16,507] INFO - ğŸ”Œ Initializing optional services...
[2025-10-17 16:53:16,507] INFO - âœ… All services initialized successfully!
[2025-10-17 16:53:16,507] INFO - ğŸš€ Application startup complete!
[2025-10-17 16:53:16,507] INFO - ================================================================================
INFO:     Application startup complete.
WARNING:  WatchFiles detected changes in 'routes/order_routes.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
[2025-10-17 16:53:23,791] INFO - Database disconnected
[2025-10-17 16:53:23,791] INFO - ğŸ›‘ Application shutdown complete
INFO:     Application shutdown complete.
INFO:     Finished server process [31362]
[2025-10-17 16:53:25,017] INFO - âœ… MCP router included
[2025-10-17 16:53:25,021] INFO - âœ… Operations router included
[2025-10-17 16:53:25,074] INFO - âœ… MCP router included
[2025-10-17 16:53:25,078] INFO - âœ… Operations router included
INFO:     Started server process [31367]
INFO:     Waiting for application startup.
[2025-10-17 16:53:25,079] INFO - ğŸš€ Starting Pivota Infrastructure Dashboard...
[2025-10-17 16:53:25,079] INFO - ğŸ“¡ Connecting to database...
[2025-10-17 16:53:25,079] INFO -    Database URL type: <class 'databases.core.DatabaseURL'>
[2025-10-17 16:53:25,079] INFO -    Database driver: sqlite
[2025-10-17 16:53:25,079] INFO - âœ… Database connected successfully
[2025-10-17 16:53:25,079] INFO - âœ… Database connection test passed
[2025-10-17 16:53:25,079] INFO - ğŸ“‹ Creating tables...
[2025-10-17 16:53:25,080] INFO - âœ… Tables created:
[2025-10-17 16:53:25,080] INFO -    - Core: merchants, kyb_documents, merchant_onboarding, payment_router_config, orders
[2025-10-17 16:53:25,080] INFO -    - Cache: products_cache
[2025-10-17 16:53:25,080] INFO -    - Events: api_call_events, order_events
[2025-10-17 16:53:25,080] INFO -    - Analytics: merchant_analytics
[2025-10-17 16:53:25,080] INFO - ğŸ”„ Running database migrations...
[2025-10-17 16:53:25,080] INFO -    Checking for store_url column...
[2025-10-17 16:53:25,081] WARNING - âš ï¸ Migration warning (may be already applied): no such table: information_schema.columns
[2025-10-17 16:53:25,081] INFO - ğŸ”Œ Initializing optional services...
[2025-10-17 16:53:25,081] INFO - âœ… All services initialized successfully!
[2025-10-17 16:53:25,081] INFO - ğŸš€ Application startup complete!
[2025-10-17 16:53:25,081] INFO - ================================================================================
INFO:     Application startup complete.
WARNING:  WatchFiles detected changes in 'routes/order_routes.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
[2025-10-17 16:53:34,886] INFO - Database disconnected
[2025-10-17 16:53:34,886] INFO - ğŸ›‘ Application shutdown complete
INFO:     Application shutdown complete.
INFO:     Finished server process [31367]
[2025-10-17 16:53:36,185] INFO - âœ… MCP router included
[2025-10-17 16:53:36,188] INFO - âœ… Operations router included
[2025-10-17 16:53:36,243] INFO - âœ… MCP router included
[2025-10-17 16:53:36,247] INFO - âœ… Operations router included
INFO:     Started server process [31377]
INFO:     Waiting for application startup.
[2025-10-17 16:53:36,248] INFO - ğŸš€ Starting Pivota Infrastructure Dashboard...
[2025-10-17 16:53:36,248] INFO - ğŸ“¡ Connecting to database...
[2025-10-17 16:53:36,248] INFO -    Database URL type: <class 'databases.core.DatabaseURL'>
[2025-10-17 16:53:36,248] INFO -    Database driver: sqlite
[2025-10-17 16:53:36,248] INFO - âœ… Database connected successfully
[2025-10-17 16:53:36,249] INFO - âœ… Database connection test passed
[2025-10-17 16:53:36,249] INFO - ğŸ“‹ Creating tables...
[2025-10-17 16:53:36,250] INFO - âœ… Tables created:
[2025-10-17 16:53:36,250] INFO -    - Core: merchants, kyb_documents, merchant_onboarding, payment_router_config, orders
[2025-10-17 16:53:36,250] INFO -    - Cache: products_cache
[2025-10-17 16:53:36,250] INFO -    - Events: api_call_events, order_events
[2025-10-17 16:53:36,250] INFO -    - Analytics: merchant_analytics
[2025-10-17 16:53:36,250] INFO - ğŸ”„ Running database migrations...
[2025-10-17 16:53:36,250] INFO -    Checking for store_url column...
[2025-10-17 16:53:36,251] WARNING - âš ï¸ Migration warning (may be already applied): no such table: information_schema.columns
[2025-10-17 16:53:36,251] INFO - ğŸ”Œ Initializing optional services...
[2025-10-17 16:53:36,251] INFO - âœ… All services initialized successfully!
[2025-10-17 16:53:36,251] INFO - ğŸš€ Application startup complete!
[2025-10-17 16:53:36,251] INFO - ================================================================================
INFO:     Application startup complete.
WARNING:  WatchFiles detected changes in 'routes/webhook_routes.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
[2025-10-17 16:54:10,615] INFO - Database disconnected
[2025-10-17 16:54:10,615] INFO - ğŸ›‘ Application shutdown complete
INFO:     Application shutdown complete.
INFO:     Finished server process [31377]
WARNING:  WatchFiles detected changes in 'routes/webhook_routes.py'. Reloading...
[2025-10-17 16:54:12,464] INFO - âœ… MCP router included
[2025-10-17 16:54:12,469] INFO - âœ… Operations router included
[2025-10-17 16:54:12,526] INFO - âœ… MCP router included
[2025-10-17 16:54:12,530] INFO - âœ… Operations router included
INFO:     Started server process [31388]
INFO:     Waiting for application startup.
[2025-10-17 16:54:12,531] INFO - ğŸš€ Starting Pivota Infrastructure Dashboard...
[2025-10-17 16:54:12,531] INFO - ğŸ“¡ Connecting to database...
[2025-10-17 16:54:12,531] INFO -    Database URL type: <class 'databases.core.DatabaseURL'>
[2025-10-17 16:54:12,531] INFO -    Database driver: sqlite
[2025-10-17 16:54:12,531] INFO - âœ… Database connected successfully
[2025-10-17 16:54:12,531] INFO - âœ… Database connection test passed
[2025-10-17 16:54:12,531] INFO - ğŸ“‹ Creating tables...
[2025-10-17 16:54:12,532] INFO - âœ… Tables created:
[2025-10-17 16:54:12,532] INFO -    - Core: merchants, kyb_documents, merchant_onboarding, payment_router_config, orders
[2025-10-17 16:54:12,532] INFO -    - Cache: products_cache
[2025-10-17 16:54:12,532] INFO -    - Events: api_call_events, order_events
[2025-10-17 16:54:12,532] INFO -    - Analytics: merchant_analytics
[2025-10-17 16:54:12,532] INFO - ğŸ”„ Running database migrations...
[2025-10-17 16:54:12,532] INFO -    Checking for store_url column...
[2025-10-17 16:54:12,533] WARNING - âš ï¸ Migration warning (may be already applied): no such table: information_schema.columns
[2025-10-17 16:54:12,533] INFO - ğŸ”Œ Initializing optional services...
[2025-10-17 16:54:12,533] INFO - âœ… All services initialized successfully!
[2025-10-17 16:54:12,533] INFO - ğŸš€ Application startup complete!
[2025-10-17 16:54:12,533] INFO - ================================================================================
INFO:     Application startup complete.
WARNING:  WatchFiles detected changes in 'routes/webhook_routes.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
[2025-10-17 16:54:23,253] INFO - Database disconnected
[2025-10-17 16:54:23,253] INFO - ğŸ›‘ Application shutdown complete
INFO:     Application shutdown complete.
INFO:     Finished server process [31388]
[2025-10-17 16:54:24,856] INFO - âœ… MCP router included
[2025-10-17 16:54:24,861] INFO - âœ… Operations router included
[2025-10-17 16:54:24,942] INFO - âœ… MCP router included
[2025-10-17 16:54:24,948] INFO - âœ… Operations router included
INFO:     Started server process [31403]
INFO:     Waiting for application startup.
[2025-10-17 16:54:24,949] INFO - ğŸš€ Starting Pivota Infrastructure Dashboard...
[2025-10-17 16:54:24,949] INFO - ğŸ“¡ Connecting to database...
[2025-10-17 16:54:24,949] INFO -    Database URL type: <class 'databases.core.DatabaseURL'>
[2025-10-17 16:54:24,949] INFO -    Database driver: sqlite
[2025-10-17 16:54:24,949] INFO - âœ… Database connected successfully
[2025-10-17 16:54:24,950] INFO - âœ… Database connection test passed
[2025-10-17 16:54:24,950] INFO - ğŸ“‹ Creating tables...
[2025-10-17 16:54:24,950] INFO - âœ… Tables created:
[2025-10-17 16:54:24,950] INFO -    - Core: merchants, kyb_documents, merchant_onboarding, payment_router_config, orders
[2025-10-17 16:54:24,950] INFO -    - Cache: products_cache
[2025-10-17 16:54:24,950] INFO -    - Events: api_call_events, order_events
[2025-10-17 16:54:24,950] INFO -    - Analytics: merchant_analytics
[2025-10-17 16:54:24,951] INFO - ğŸ”„ Running database migrations...
[2025-10-17 16:54:24,951] INFO -    Checking for store_url column...
[2025-10-17 16:54:24,951] WARNING - âš ï¸ Migration warning (may be already applied): no such table: information_schema.columns
[2025-10-17 16:54:24,951] INFO - ğŸ”Œ Initializing optional services...
[2025-10-17 16:54:24,951] INFO - âœ… All services initialized successfully!
[2025-10-17 16:54:24,951] INFO - ğŸš€ Application startup complete!
[2025-10-17 16:54:24,951] INFO - ================================================================================
INFO:     Application startup complete.
WARNING:  WatchFiles detected changes in 'main.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
[2025-10-17 16:54:25,901] INFO - Database disconnected
[2025-10-17 16:54:25,901] INFO - ğŸ›‘ Application shutdown complete
INFO:     Application shutdown complete.
INFO:     Finished server process [31403]
[2025-10-17 16:54:26,974] INFO - âœ… MCP router included
[2025-10-17 16:54:26,977] INFO - âœ… Operations router included
[2025-10-17 16:54:27,027] INFO - âœ… MCP router included
[2025-10-17 16:54:27,031] INFO - âœ… Operations router included
INFO:     Started server process [31410]
INFO:     Waiting for application startup.
[2025-10-17 16:54:27,032] INFO - ğŸš€ Starting Pivota Infrastructure Dashboard...
[2025-10-17 16:54:27,032] INFO - ğŸ“¡ Connecting to database...
[2025-10-17 16:54:27,032] INFO -    Database URL type: <class 'databases.core.DatabaseURL'>
[2025-10-17 16:54:27,032] INFO -    Database driver: sqlite
[2025-10-17 16:54:27,032] INFO - âœ… Database connected successfully
[2025-10-17 16:54:27,033] INFO - âœ… Database connection test passed
[2025-10-17 16:54:27,033] INFO - ğŸ“‹ Creating tables...
[2025-10-17 16:54:27,033] INFO - âœ… Tables created:
[2025-10-17 16:54:27,033] INFO -    - Core: merchants, kyb_documents, merchant_onboarding, payment_router_config, orders
[2025-10-17 16:54:27,033] INFO -    - Cache: products_cache
[2025-10-17 16:54:27,033] INFO -    - Events: api_call_events, order_events
[2025-10-17 16:54:27,033] INFO -    - Analytics: merchant_analytics
[2025-10-17 16:54:27,033] INFO - ğŸ”„ Running database migrations...
[2025-10-17 16:54:27,033] INFO -    Checking for store_url column...
[2025-10-17 16:54:27,034] WARNING - âš ï¸ Migration warning (may be already applied): no such table: information_schema.columns
[2025-10-17 16:54:27,034] INFO - ğŸ”Œ Initializing optional services...
[2025-10-17 16:54:27,034] INFO - âœ… All services initialized successfully!
[2025-10-17 16:54:27,034] INFO - ğŸš€ Application startup complete!
[2025-10-17 16:54:27,034] INFO - ================================================================================
INFO:     Application startup complete.
WARNING:  WatchFiles detected changes in 'main.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
[2025-10-17 16:54:37,353] INFO - Database disconnected
[2025-10-17 16:54:37,353] INFO - ğŸ›‘ Application shutdown complete
INFO:     Application shutdown complete.
INFO:     Finished server process [31410]
WARNING:  WatchFiles detected changes in 'main.py'. Reloading...
[2025-10-17 16:54:39,302] INFO - âœ… MCP router included
[2025-10-17 16:54:39,307] INFO - âœ… Operations router included
[2025-10-17 16:54:39,376] INFO - âœ… MCP router included
[2025-10-17 16:54:39,381] INFO - âœ… Operations router included
INFO:     Started server process [31424]
INFO:     Waiting for application startup.
[2025-10-17 16:54:39,382] INFO - ğŸš€ Starting Pivota Infrastructure Dashboard...
[2025-10-17 16:54:39,382] INFO - ğŸ“¡ Connecting to database...
[2025-10-17 16:54:39,382] INFO -    Database URL type: <class 'databases.core.DatabaseURL'>
[2025-10-17 16:54:39,382] INFO -    Database driver: sqlite
[2025-10-17 16:54:39,382] INFO - âœ… Database connected successfully
[2025-10-17 16:54:39,383] INFO - âœ… Database connection test passed
[2025-10-17 16:54:39,383] INFO - ğŸ“‹ Creating tables...
[2025-10-17 16:54:39,384] INFO - âœ… Tables created:
[2025-10-17 16:54:39,385] INFO -    - Core: merchants, kyb_documents, merchant_onboarding, payment_router_config, orders
[2025-10-17 16:54:39,385] INFO -    - Cache: products_cache
[2025-10-17 16:54:39,385] INFO -    - Events: api_call_events, order_events
[2025-10-17 16:54:39,385] INFO -    - Analytics: merchant_analytics
[2025-10-17 16:54:39,385] INFO - ğŸ”„ Running database migrations...
[2025-10-17 16:54:39,385] INFO -    Checking for store_url column...
[2025-10-17 16:54:39,385] WARNING - âš ï¸ Migration warning (may be already applied): no such table: information_schema.columns
[2025-10-17 16:54:39,385] INFO - ğŸ”Œ Initializing optional services...
[2025-10-17 16:54:39,386] INFO - âœ… All services initialized successfully!
[2025-10-17 16:54:39,386] INFO - ğŸš€ Application startup complete!
[2025-10-17 16:54:39,386] INFO - ================================================================================
INFO:     Application startup complete.
WARNING:  WatchFiles detected changes in 'main.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
[2025-10-17 16:54:48,886] INFO - Database disconnected
[2025-10-17 16:54:48,887] INFO - ğŸ›‘ Application shutdown complete
INFO:     Application shutdown complete.
INFO:     Finished server process [31424]
[2025-10-17 16:54:50,084] INFO - âœ… MCP router included
[2025-10-17 16:54:50,089] INFO - âœ… Operations router included
[2025-10-17 16:54:50,152] INFO - âœ… MCP router included
[2025-10-17 16:54:50,157] INFO - âœ… Operations router included
INFO:     Started server process [31431]
INFO:     Waiting for application startup.
[2025-10-17 16:54:50,158] INFO - ğŸš€ Starting Pivota Infrastructure Dashboard...
[2025-10-17 16:54:50,158] INFO - ğŸ“¡ Connecting to database...
[2025-10-17 16:54:50,158] INFO -    Database URL type: <class 'databases.core.DatabaseURL'>
[2025-10-17 16:54:50,158] INFO -    Database driver: sqlite
[2025-10-17 16:54:50,158] INFO - âœ… Database connected successfully
[2025-10-17 16:54:50,159] INFO - âœ… Database connection test passed
[2025-10-17 16:54:50,159] INFO - ğŸ“‹ Creating tables...
[2025-10-17 16:54:50,160] INFO - âœ… Tables created:
[2025-10-17 16:54:50,160] INFO -    - Core: merchants, kyb_documents, merchant_onboarding, payment_router_config, orders
[2025-10-17 16:54:50,160] INFO -    - Cache: products_cache
[2025-10-17 16:54:50,160] INFO -    - Events: api_call_events, order_events
[2025-10-17 16:54:50,160] INFO -    - Analytics: merchant_analytics
[2025-10-17 16:54:50,160] INFO - ğŸ”„ Running database migrations...
[2025-10-17 16:54:50,160] INFO -    Checking for store_url column...
[2025-10-17 16:54:50,161] WARNING - âš ï¸ Migration warning (may be already applied): no such table: information_schema.columns
[2025-10-17 16:54:50,161] INFO - ğŸ”Œ Initializing optional services...
[2025-10-17 16:54:50,161] INFO - âœ… All services initialized successfully!
[2025-10-17 16:54:50,161] INFO - ğŸš€ Application startup complete!
[2025-10-17 16:54:50,161] INFO - ================================================================================
INFO:     Application startup complete.
WARNING:  WatchFiles detected changes in 'routes/order_routes.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
[2025-10-17 19:40:15,784] INFO - Database disconnected
[2025-10-17 19:40:15,784] INFO - ğŸ›‘ Application shutdown complete
INFO:     Application shutdown complete.
INFO:     Finished server process [31431]
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/multiprocessing/spawn.py", line 116, in spawn_main
    exitcode = _main(fd, parent_sentinel)
  File "/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/multiprocessing/spawn.py", line 125, in _main
    prepare(preparation_data)
  File "/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/multiprocessing/spawn.py", line 236, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/multiprocessing/spawn.py", line 287, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
  File "/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/runpy.py", line 268, in run_path
    return _run_module_code(code, init_globals, run_name,
  File "/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/runpy.py", line 97, in _run_module_code
    _run_code(code, mod_globals, init_globals,
  File "/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/runpy.py", line 87, in _run_code
    exec(code, run_globals)
  File "/Users/pengchydan/Desktop/Pivota Infra/Pivota-cursor-create-project-directory-structure-8344/pivota_infra/main.py", line 41, in <module>
    from routes.order_routes import router as order_router
  File "/Users/pengchydan/Desktop/Pivota Infra/Pivota-cursor-create-project-directory-structure-8344/pivota_infra/routes/order_routes.py", line 24, in <module>
    from db.order_events import log_order_event
ModuleNotFoundError: No module named 'db.order_events'
WARNING:  WatchFiles detected changes in 'routes/webhook_routes.py'. Reloading...
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/multiprocessing/spawn.py", line 116, in spawn_main
    exitcode = _main(fd, parent_sentinel)
  File "/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/multiprocessing/spawn.py", line 125, in _main
    prepare(preparation_data)
  File "/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/multiprocessing/spawn.py", line 236, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/multiprocessing/spawn.py", line 287, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
  File "/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/runpy.py", line 268, in run_path
    return _run_module_code(code, init_globals, run_name,
  File "/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/runpy.py", line 97, in _run_module_code
    _run_code(code, mod_globals, init_globals,
  File "/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/runpy.py", line 87, in _run_code
    exec(code, run_globals)
  File "/Users/pengchydan/Desktop/Pivota Infra/Pivota-cursor-create-project-directory-structure-8344/pivota_infra/main.py", line 41, in <module>
    from routes.order_routes import router as order_router
  File "/Users/pengchydan/Desktop/Pivota Infra/Pivota-cursor-create-project-directory-structure-8344/pivota_infra/routes/order_routes.py", line 24, in <module>
    from db.order_events import log_order_event
ModuleNotFoundError: No module named 'db.order_events'
WARNING:  WatchFiles detected changes in 'routes/order_routes.py'. Reloading...
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/multiprocessing/spawn.py", line 116, in spawn_main
    exitcode = _main(fd, parent_sentinel)
  File "/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/multiprocessing/spawn.py", line 125, in _main
    prepare(preparation_data)
  File "/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/multiprocessing/spawn.py", line 236, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/multiprocessing/spawn.py", line 287, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
  File "/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/runpy.py", line 268, in run_path
    return _run_module_code(code, init_globals, run_name,
  File "/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/runpy.py", line 97, in _run_module_code
    _run_code(code, mod_globals, init_globals,
  File "/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/runpy.py", line 87, in _run_code
    exec(code, run_globals)
  File "/Users/pengchydan/Desktop/Pivota Infra/Pivota-cursor-create-project-directory-structure-8344/pivota_infra/main.py", line 41, in <module>
    from routes.order_routes import router as order_router
  File "/Users/pengchydan/Desktop/Pivota Infra/Pivota-cursor-create-project-directory-structure-8344/pivota_infra/routes/order_routes.py", line 24, in <module>
    from db.order_events import log_order_event
ModuleNotFoundError: No module named 'db.order_events'
WARNING:  WatchFiles detected changes in 'routes/webhook_routes.py'. Reloading...
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/multiprocessing/spawn.py", line 116, in spawn_main
    exitcode = _main(fd, parent_sentinel)
  File "/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/multiprocessing/spawn.py", line 125, in _main
    prepare(preparation_data)
  File "/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/multiprocessing/spawn.py", line 236, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/multiprocessing/spawn.py", line 287, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
  File "/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/runpy.py", line 268, in run_path
    return _run_module_code(code, init_globals, run_name,
  File "/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/runpy.py", line 97, in _run_module_code
    _run_code(code, mod_globals, init_globals,
  File "/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/runpy.py", line 87, in _run_code
    exec(code, run_globals)
  File "/Users/pengchydan/Desktop/Pivota Infra/Pivota-cursor-create-project-directory-structure-8344/pivota_infra/main.py", line 41, in <module>
    from routes.order_routes import router as order_router
  File "/Users/pengchydan/Desktop/Pivota Infra/Pivota-cursor-create-project-directory-structure-8344/pivota_infra/routes/order_routes.py", line 24, in <module>
    from db.order_events import log_order_event
ModuleNotFoundError: No module named 'db.order_events'
WARNING:  WatchFiles detected changes in 'routes/webhook_routes.py', 'routes/order_routes.py'. Reloading...
[2025-10-17 19:45:38,523] INFO - âœ… MCP router included
[2025-10-17 19:45:38,527] INFO - âœ… Operations router included
[2025-10-17 19:45:38,592] INFO - âœ… MCP router included
[2025-10-17 19:45:38,597] INFO - âœ… Operations router included
INFO:     Started server process [32419]
INFO:     Waiting for application startup.
[2025-10-17 19:45:38,598] INFO - ğŸš€ Starting Pivota Infrastructure Dashboard...
[2025-10-17 19:45:38,598] INFO - ğŸ“¡ Connecting to database...
[2025-10-17 19:45:38,598] INFO -    Database URL type: <class 'databases.core.DatabaseURL'>
[2025-10-17 19:45:38,598] INFO -    Database driver: sqlite
[2025-10-17 19:45:38,598] INFO - âœ… Database connected successfully
[2025-10-17 19:45:38,600] INFO - âœ… Database connection test passed
[2025-10-17 19:45:38,600] INFO - ğŸ“‹ Creating tables...
[2025-10-17 19:45:38,601] INFO - âœ… Tables created:
[2025-10-17 19:45:38,601] INFO -    - Core: merchants, kyb_documents, merchant_onboarding, payment_router_config, orders
[2025-10-17 19:45:38,601] INFO -    - Cache: products_cache
[2025-10-17 19:45:38,601] INFO -    - Events: api_call_events, order_events
[2025-10-17 19:45:38,601] INFO -    - Analytics: merchant_analytics
[2025-10-17 19:45:38,601] INFO - ğŸ”„ Running database migrations...
[2025-10-17 19:45:38,601] INFO -    Checking for store_url column...
[2025-10-17 19:45:38,602] WARNING - âš ï¸ Migration warning (may be already applied): no such table: information_schema.columns
[2025-10-17 19:45:38,602] INFO - ğŸ”Œ Initializing optional services...
[2025-10-17 19:45:38,602] INFO - âœ… All services initialized successfully!
[2025-10-17 19:45:38,602] INFO - ğŸš€ Application startup complete!
[2025-10-17 19:45:38,602] INFO - ================================================================================
INFO:     Application startup complete.
WARNING:  WatchFiles detected changes in 'routes/order_routes.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
[2025-10-17 19:45:51,050] INFO - Database disconnected
[2025-10-17 19:45:51,050] INFO - ğŸ›‘ Application shutdown complete
INFO:     Application shutdown complete.
INFO:     Finished server process [32419]
[2025-10-17 19:45:52,636] INFO - âœ… MCP router included
[2025-10-17 19:45:52,641] INFO - âœ… Operations router included
[2025-10-17 19:45:52,702] INFO - âœ… MCP router included
[2025-10-17 19:45:52,707] INFO - âœ… Operations router included
INFO:     Started server process [32430]
INFO:     Waiting for application startup.
[2025-10-17 19:45:52,707] INFO - ğŸš€ Starting Pivota Infrastructure Dashboard...
[2025-10-17 19:45:52,707] INFO - ğŸ“¡ Connecting to database...
[2025-10-17 19:45:52,707] INFO -    Database URL type: <class 'databases.core.DatabaseURL'>
[2025-10-17 19:45:52,707] INFO -    Database driver: sqlite
[2025-10-17 19:45:52,707] INFO - âœ… Database connected successfully
[2025-10-17 19:45:52,708] INFO - âœ… Database connection test passed
[2025-10-17 19:45:52,708] INFO - ğŸ“‹ Creating tables...
[2025-10-17 19:45:52,709] INFO - âœ… Tables created:
[2025-10-17 19:45:52,709] INFO -    - Core: merchants, kyb_documents, merchant_onboarding, payment_router_config, orders
[2025-10-17 19:45:52,709] INFO -    - Cache: products_cache
[2025-10-17 19:45:52,709] INFO -    - Events: api_call_events, order_events
[2025-10-17 19:45:52,709] INFO -    - Analytics: merchant_analytics
[2025-10-17 19:45:52,709] INFO - ğŸ”„ Running database migrations...
[2025-10-17 19:45:52,709] INFO -    Checking for store_url column...
[2025-10-17 19:45:52,709] WARNING - âš ï¸ Migration warning (may be already applied): no such table: information_schema.columns
[2025-10-17 19:45:52,710] INFO - ğŸ”Œ Initializing optional services...
[2025-10-17 19:45:52,710] INFO - âœ… All services initialized successfully!
[2025-10-17 19:45:52,710] INFO - ğŸš€ Application startup complete!
[2025-10-17 19:45:52,710] INFO - ================================================================================
INFO:     Application startup complete.
WARNING:  WatchFiles detected changes in 'routes/webhook_routes.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
[2025-10-17 19:45:53,318] INFO - Database disconnected
[2025-10-17 19:45:53,318] INFO - ğŸ›‘ Application shutdown complete
INFO:     Application shutdown complete.
INFO:     Finished server process [32430]
[2025-10-17 19:45:54,441] INFO - âœ… MCP router included
[2025-10-17 19:45:54,445] INFO - âœ… Operations router included
[2025-10-17 19:45:54,500] INFO - âœ… MCP router included
[2025-10-17 19:45:54,505] INFO - âœ… Operations router included
INFO:     Started server process [32437]
INFO:     Waiting for application startup.
[2025-10-17 19:45:54,506] INFO - ğŸš€ Starting Pivota Infrastructure Dashboard...
[2025-10-17 19:45:54,506] INFO - ğŸ“¡ Connecting to database...
[2025-10-17 19:45:54,506] INFO -    Database URL type: <class 'databases.core.DatabaseURL'>
[2025-10-17 19:45:54,506] INFO -    Database driver: sqlite
[2025-10-17 19:45:54,506] INFO - âœ… Database connected successfully
[2025-10-17 19:45:54,507] INFO - âœ… Database connection test passed
[2025-10-17 19:45:54,507] INFO - ğŸ“‹ Creating tables...
[2025-10-17 19:45:54,508] INFO - âœ… Tables created:
[2025-10-17 19:45:54,508] INFO -    - Core: merchants, kyb_documents, merchant_onboarding, payment_router_config, orders
[2025-10-17 19:45:54,508] INFO -    - Cache: products_cache
[2025-10-17 19:45:54,508] INFO -    - Events: api_call_events, order_events
[2025-10-17 19:45:54,508] INFO -    - Analytics: merchant_analytics
[2025-10-17 19:45:54,508] INFO - ğŸ”„ Running database migrations...
[2025-10-17 19:45:54,508] INFO -    Checking for store_url column...
[2025-10-17 19:45:54,508] WARNING - âš ï¸ Migration warning (may be already applied): no such table: information_schema.columns
[2025-10-17 19:45:54,509] INFO - ğŸ”Œ Initializing optional services...
[2025-10-17 19:45:54,509] INFO - âœ… All services initialized successfully!
[2025-10-17 19:45:54,509] INFO - ğŸš€ Application startup complete!
[2025-10-17 19:45:54,509] INFO - ================================================================================
INFO:     Application startup complete.
WARNING:  WatchFiles detected changes in 'db/agents.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
[2025-10-17 19:48:00,556] INFO - Database disconnected
[2025-10-17 19:48:00,557] INFO - ğŸ›‘ Application shutdown complete
INFO:     Application shutdown complete.
INFO:     Finished server process [32437]
WARNING:  WatchFiles detected changes in 'db/agents.py'. Reloading...
[2025-10-17 19:48:02,421] INFO - âœ… MCP router included
[2025-10-17 19:48:02,425] INFO - âœ… Operations router included
[2025-10-17 19:48:02,480] INFO - âœ… MCP router included
[2025-10-17 19:48:02,484] INFO - âœ… Operations router included
INFO:     Started server process [32459]
INFO:     Waiting for application startup.
[2025-10-17 19:48:02,485] INFO - ğŸš€ Starting Pivota Infrastructure Dashboard...
[2025-10-17 19:48:02,486] INFO - ğŸ“¡ Connecting to database...
[2025-10-17 19:48:02,486] INFO -    Database URL type: <class 'databases.core.DatabaseURL'>
[2025-10-17 19:48:02,486] INFO -    Database driver: sqlite
[2025-10-17 19:48:02,486] INFO - âœ… Database connected successfully
[2025-10-17 19:48:02,486] INFO - âœ… Database connection test passed
[2025-10-17 19:48:02,487] INFO - ğŸ“‹ Creating tables...
[2025-10-17 19:48:02,488] INFO - âœ… Tables created:
[2025-10-17 19:48:02,488] INFO -    - Core: merchants, kyb_documents, merchant_onboarding, payment_router_config, orders
[2025-10-17 19:48:02,488] INFO -    - Cache: products_cache
[2025-10-17 19:48:02,488] INFO -    - Events: api_call_events, order_events
[2025-10-17 19:48:02,488] INFO -    - Analytics: merchant_analytics
[2025-10-17 19:48:02,488] INFO - ğŸ”„ Running database migrations...
[2025-10-17 19:48:02,488] INFO -    Checking for store_url column...
[2025-10-17 19:48:02,488] WARNING - âš ï¸ Migration warning (may be already applied): no such table: information_schema.columns
[2025-10-17 19:48:02,488] INFO - ğŸ”Œ Initializing optional services...
[2025-10-17 19:48:02,488] INFO - âœ… All services initialized successfully!
[2025-10-17 19:48:02,488] INFO - ğŸš€ Application startup complete!
[2025-10-17 19:48:02,488] INFO - ================================================================================
INFO:     Application startup complete.
WARNING:  WatchFiles detected changes in 'db/agents.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
[2025-10-17 19:48:17,862] INFO - Database disconnected
[2025-10-17 19:48:17,862] INFO - ğŸ›‘ Application shutdown complete
INFO:     Application shutdown complete.
INFO:     Finished server process [32459]
[2025-10-17 19:48:19,283] INFO - âœ… MCP router included
[2025-10-17 19:48:19,287] INFO - âœ… Operations router included
[2025-10-17 19:48:19,344] INFO - âœ… MCP router included
[2025-10-17 19:48:19,347] INFO - âœ… Operations router included
INFO:     Started server process [32472]
INFO:     Waiting for application startup.
[2025-10-17 19:48:19,348] INFO - ğŸš€ Starting Pivota Infrastructure Dashboard...
[2025-10-17 19:48:19,348] INFO - ğŸ“¡ Connecting to database...
[2025-10-17 19:48:19,348] INFO -    Database URL type: <class 'databases.core.DatabaseURL'>
[2025-10-17 19:48:19,348] INFO -    Database driver: sqlite
[2025-10-17 19:48:19,348] INFO - âœ… Database connected successfully
[2025-10-17 19:48:19,349] INFO - âœ… Database connection test passed
[2025-10-17 19:48:19,349] INFO - ğŸ“‹ Creating tables...
[2025-10-17 19:48:19,350] INFO - âœ… Tables created:
[2025-10-17 19:48:19,350] INFO -    - Core: merchants, kyb_documents, merchant_onboarding, payment_router_config, orders
[2025-10-17 19:48:19,350] INFO -    - Cache: products_cache
[2025-10-17 19:48:19,350] INFO -    - Events: api_call_events, order_events
[2025-10-17 19:48:19,350] INFO -    - Analytics: merchant_analytics
[2025-10-17 19:48:19,350] INFO - ğŸ”„ Running database migrations...
[2025-10-17 19:48:19,350] INFO -    Checking for store_url column...
[2025-10-17 19:48:19,351] WARNING - âš ï¸ Migration warning (may be already applied): no such table: information_schema.columns
[2025-10-17 19:48:19,351] INFO - ğŸ”Œ Initializing optional services...
[2025-10-17 19:48:19,351] INFO - âœ… All services initialized successfully!
[2025-10-17 19:48:19,351] INFO - ğŸš€ Application startup complete!
[2025-10-17 19:48:19,351] INFO - ================================================================================
INFO:     Application startup complete.
WARNING:  WatchFiles detected changes in 'routes/agent_auth.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
[2025-10-17 19:48:38,150] INFO - Database disconnected
[2025-10-17 19:48:38,150] INFO - ğŸ›‘ Application shutdown complete
INFO:     Application shutdown complete.
INFO:     Finished server process [32472]
WARNING:  WatchFiles detected changes in 'routes/agent_auth.py'. Reloading...
WARNING:  WatchFiles detected changes in 'routes/agent_auth.py'. Reloading...
[2025-10-17 19:48:40,168] INFO - âœ… MCP router included
[2025-10-17 19:48:40,172] INFO - âœ… Operations router included
[2025-10-17 19:48:40,224] INFO - âœ… MCP router included
[2025-10-17 19:48:40,228] INFO - âœ… Operations router included
INFO:     Started server process [32492]
INFO:     Waiting for application startup.
[2025-10-17 19:48:40,229] INFO - ğŸš€ Starting Pivota Infrastructure Dashboard...
[2025-10-17 19:48:40,229] INFO - ğŸ“¡ Connecting to database...
[2025-10-17 19:48:40,229] INFO -    Database URL type: <class 'databases.core.DatabaseURL'>
[2025-10-17 19:48:40,229] INFO -    Database driver: sqlite
[2025-10-17 19:48:40,229] INFO - âœ… Database connected successfully
[2025-10-17 19:48:40,229] INFO - âœ… Database connection test passed
[2025-10-17 19:48:40,229] INFO - ğŸ“‹ Creating tables...
[2025-10-17 19:48:40,231] INFO - âœ… Tables created:
[2025-10-17 19:48:40,231] INFO -    - Core: merchants, kyb_documents, merchant_onboarding, payment_router_config, orders
[2025-10-17 19:48:40,231] INFO -    - Cache: products_cache
[2025-10-17 19:48:40,231] INFO -    - Events: api_call_events, order_events
[2025-10-17 19:48:40,231] INFO -    - Analytics: merchant_analytics
[2025-10-17 19:48:40,231] INFO - ğŸ”„ Running database migrations...
[2025-10-17 19:48:40,231] INFO -    Checking for store_url column...
[2025-10-17 19:48:40,232] WARNING - âš ï¸ Migration warning (may be already applied): no such table: information_schema.columns
[2025-10-17 19:48:40,232] INFO - ğŸ”Œ Initializing optional services...
[2025-10-17 19:48:40,232] INFO - âœ… All services initialized successfully!
[2025-10-17 19:48:40,232] INFO - ğŸš€ Application startup complete!
[2025-10-17 19:48:40,232] INFO - ================================================================================
INFO:     Application startup complete.
WARNING:  WatchFiles detected changes in 'routes/agent_auth.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
[2025-10-17 19:48:51,855] INFO - Database disconnected
[2025-10-17 19:48:51,856] INFO - ğŸ›‘ Application shutdown complete
INFO:     Application shutdown complete.
INFO:     Finished server process [32492]
[2025-10-17 19:48:53,136] INFO - âœ… MCP router included
[2025-10-17 19:48:53,141] INFO - âœ… Operations router included
[2025-10-17 19:48:53,202] INFO - âœ… MCP router included
[2025-10-17 19:48:53,206] INFO - âœ… Operations router included
INFO:     Started server process [32504]
INFO:     Waiting for application startup.
[2025-10-17 19:48:53,207] INFO - ğŸš€ Starting Pivota Infrastructure Dashboard...
[2025-10-17 19:48:53,207] INFO - ğŸ“¡ Connecting to database...
[2025-10-17 19:48:53,207] INFO -    Database URL type: <class 'databases.core.DatabaseURL'>
[2025-10-17 19:48:53,207] INFO -    Database driver: sqlite
[2025-10-17 19:48:53,207] INFO - âœ… Database connected successfully
[2025-10-17 19:48:53,208] INFO - âœ… Database connection test passed
[2025-10-17 19:48:53,208] INFO - ğŸ“‹ Creating tables...
[2025-10-17 19:48:53,208] INFO - âœ… Tables created:
[2025-10-17 19:48:53,208] INFO -    - Core: merchants, kyb_documents, merchant_onboarding, payment_router_config, orders
[2025-10-17 19:48:53,208] INFO -    - Cache: products_cache
[2025-10-17 19:48:53,208] INFO -    - Events: api_call_events, order_events
[2025-10-17 19:48:53,209] INFO -    - Analytics: merchant_analytics
[2025-10-17 19:48:53,209] INFO - ğŸ”„ Running database migrations...
[2025-10-17 19:48:53,209] INFO -    Checking for store_url column...
[2025-10-17 19:48:53,209] WARNING - âš ï¸ Migration warning (may be already applied): no such table: information_schema.columns
[2025-10-17 19:48:53,209] INFO - ğŸ”Œ Initializing optional services...
[2025-10-17 19:48:53,209] INFO - âœ… All services initialized successfully!
[2025-10-17 19:48:53,210] INFO - ğŸš€ Application startup complete!
[2025-10-17 19:48:53,210] INFO - ================================================================================
INFO:     Application startup complete.
WARNING:  WatchFiles detected changes in 'routes/agent_api.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
[2025-10-17 19:49:44,534] INFO - Database disconnected
[2025-10-17 19:49:44,534] INFO - ğŸ›‘ Application shutdown complete
INFO:     Application shutdown complete.
INFO:     Finished server process [32504]
WARNING:  WatchFiles detected changes in 'routes/agent_api.py'. Reloading...
[2025-10-17 19:49:46,410] INFO - âœ… MCP router included
[2025-10-17 19:49:46,414] INFO - âœ… Operations router included
[2025-10-17 19:49:46,472] INFO - âœ… MCP router included
[2025-10-17 19:49:46,476] INFO - âœ… Operations router included
INFO:     Started server process [32520]
INFO:     Waiting for application startup.
[2025-10-17 19:49:46,476] INFO - ğŸš€ Starting Pivota Infrastructure Dashboard...
[2025-10-17 19:49:46,476] INFO - ğŸ“¡ Connecting to database...
[2025-10-17 19:49:46,476] INFO -    Database URL type: <class 'databases.core.DatabaseURL'>
[2025-10-17 19:49:46,476] INFO -    Database driver: sqlite
[2025-10-17 19:49:46,476] INFO - âœ… Database connected successfully
[2025-10-17 19:49:46,477] INFO - âœ… Database connection test passed
[2025-10-17 19:49:46,477] INFO - ğŸ“‹ Creating tables...
[2025-10-17 19:49:46,477] INFO - âœ… Tables created:
[2025-10-17 19:49:46,478] INFO -    - Core: merchants, kyb_documents, merchant_onboarding, payment_router_config, orders
[2025-10-17 19:49:46,478] INFO -    - Cache: products_cache
[2025-10-17 19:49:46,478] INFO -    - Events: api_call_events, order_events
[2025-10-17 19:49:46,478] INFO -    - Analytics: merchant_analytics
[2025-10-17 19:49:46,478] INFO - ğŸ”„ Running database migrations...
[2025-10-17 19:49:46,478] INFO -    Checking for store_url column...
[2025-10-17 19:49:46,478] WARNING - âš ï¸ Migration warning (may be already applied): no such table: information_schema.columns
[2025-10-17 19:49:46,478] INFO - ğŸ”Œ Initializing optional services...
[2025-10-17 19:49:46,478] INFO - âœ… All services initialized successfully!
[2025-10-17 19:49:46,478] INFO - ğŸš€ Application startup complete!
[2025-10-17 19:49:46,478] INFO - ================================================================================
INFO:     Application startup complete.
WARNING:  WatchFiles detected changes in 'routes/agent_api.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
[2025-10-17 19:50:02,545] INFO - Database disconnected
[2025-10-17 19:50:02,545] INFO - ğŸ›‘ Application shutdown complete
INFO:     Application shutdown complete.
INFO:     Finished server process [32520]
[2025-10-17 19:50:03,998] INFO - âœ… MCP router included
[2025-10-17 19:50:04,005] INFO - âœ… Operations router included
[2025-10-17 19:50:04,081] INFO - âœ… MCP router included
[2025-10-17 19:50:04,088] INFO - âœ… Operations router included
INFO:     Started server process [32541]
INFO:     Waiting for application startup.
[2025-10-17 19:50:04,088] INFO - ğŸš€ Starting Pivota Infrastructure Dashboard...
[2025-10-17 19:50:04,088] INFO - ğŸ“¡ Connecting to database...
[2025-10-17 19:50:04,088] INFO -    Database URL type: <class 'databases.core.DatabaseURL'>
[2025-10-17 19:50:04,088] INFO -    Database driver: sqlite
[2025-10-17 19:50:04,088] INFO - âœ… Database connected successfully
[2025-10-17 19:50:04,090] INFO - âœ… Database connection test passed
[2025-10-17 19:50:04,090] INFO - ğŸ“‹ Creating tables...
[2025-10-17 19:50:04,092] INFO - âœ… Tables created:
[2025-10-17 19:50:04,092] INFO -    - Core: merchants, kyb_documents, merchant_onboarding, payment_router_config, orders
[2025-10-17 19:50:04,092] INFO -    - Cache: products_cache
[2025-10-17 19:50:04,092] INFO -    - Events: api_call_events, order_events
[2025-10-17 19:50:04,092] INFO -    - Analytics: merchant_analytics
[2025-10-17 19:50:04,092] INFO - ğŸ”„ Running database migrations...
[2025-10-17 19:50:04,092] INFO -    Checking for store_url column...
[2025-10-17 19:50:04,094] WARNING - âš ï¸ Migration warning (may be already applied): no such table: information_schema.columns
[2025-10-17 19:50:04,094] INFO - ğŸ”Œ Initializing optional services...
[2025-10-17 19:50:04,094] INFO - âœ… All services initialized successfully!
[2025-10-17 19:50:04,094] INFO - ğŸš€ Application startup complete!
[2025-10-17 19:50:04,094] INFO - ================================================================================
INFO:     Application startup complete.
WARNING:  WatchFiles detected changes in 'routes/agent_management.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
[2025-10-17 19:51:02,516] INFO - Database disconnected
[2025-10-17 19:51:02,517] INFO - ğŸ›‘ Application shutdown complete
INFO:     Application shutdown complete.
INFO:     Finished server process [32541]
WARNING:  WatchFiles detected changes in 'routes/agent_management.py'. Reloading...
[2025-10-17 19:51:04,316] INFO - âœ… MCP router included
[2025-10-17 19:51:04,320] INFO - âœ… Operations router included
[2025-10-17 19:51:04,376] INFO - âœ… MCP router included
[2025-10-17 19:51:04,380] INFO - âœ… Operations router included
INFO:     Started server process [32554]
INFO:     Waiting for application startup.
[2025-10-17 19:51:04,381] INFO - ğŸš€ Starting Pivota Infrastructure Dashboard...
[2025-10-17 19:51:04,381] INFO - ğŸ“¡ Connecting to database...
[2025-10-17 19:51:04,381] INFO -    Database URL type: <class 'databases.core.DatabaseURL'>
[2025-10-17 19:51:04,381] INFO -    Database driver: sqlite
[2025-10-17 19:51:04,381] INFO - âœ… Database connected successfully
[2025-10-17 19:51:04,382] INFO - âœ… Database connection test passed
[2025-10-17 19:51:04,382] INFO - ğŸ“‹ Creating tables...
[2025-10-17 19:51:04,383] INFO - âœ… Tables created:
[2025-10-17 19:51:04,383] INFO -    - Core: merchants, kyb_documents, merchant_onboarding, payment_router_config, orders
[2025-10-17 19:51:04,383] INFO -    - Cache: products_cache
[2025-10-17 19:51:04,383] INFO -    - Events: api_call_events, order_events
[2025-10-17 19:51:04,383] INFO -    - Analytics: merchant_analytics
[2025-10-17 19:51:04,383] INFO - ğŸ”„ Running database migrations...
[2025-10-17 19:51:04,383] INFO -    Checking for store_url column...
[2025-10-17 19:51:04,384] WARNING - âš ï¸ Migration warning (may be already applied): no such table: information_schema.columns
[2025-10-17 19:51:04,384] INFO - ğŸ”Œ Initializing optional services...
[2025-10-17 19:51:04,384] INFO - âœ… All services initialized successfully!
[2025-10-17 19:51:04,384] INFO - ğŸš€ Application startup complete!
[2025-10-17 19:51:04,384] INFO - ================================================================================
INFO:     Application startup complete.
WARNING:  WatchFiles detected changes in 'routes/agent_management.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
[2025-10-17 19:51:45,754] INFO - Database disconnected
[2025-10-17 19:51:45,754] INFO - ğŸ›‘ Application shutdown complete
INFO:     Application shutdown complete.
INFO:     Finished server process [32554]
[2025-10-17 19:51:47,192] INFO - âœ… MCP router included
[2025-10-17 19:51:47,195] INFO - âœ… Operations router included
[2025-10-17 19:51:47,253] INFO - âœ… MCP router included
[2025-10-17 19:51:47,257] INFO - âœ… Operations router included
INFO:     Started server process [32567]
INFO:     Waiting for application startup.
[2025-10-17 19:51:47,257] INFO - ğŸš€ Starting Pivota Infrastructure Dashboard...
[2025-10-17 19:51:47,257] INFO - ğŸ“¡ Connecting to database...
[2025-10-17 19:51:47,257] INFO -    Database URL type: <class 'databases.core.DatabaseURL'>
[2025-10-17 19:51:47,257] INFO -    Database driver: sqlite
[2025-10-17 19:51:47,257] INFO - âœ… Database connected successfully
[2025-10-17 19:51:47,258] INFO - âœ… Database connection test passed
[2025-10-17 19:51:47,258] INFO - ğŸ“‹ Creating tables...
[2025-10-17 19:51:47,259] INFO - âœ… Tables created:
[2025-10-17 19:51:47,259] INFO -    - Core: merchants, kyb_documents, merchant_onboarding, payment_router_config, orders
[2025-10-17 19:51:47,259] INFO -    - Cache: products_cache
[2025-10-17 19:51:47,259] INFO -    - Events: api_call_events, order_events
[2025-10-17 19:51:47,259] INFO -    - Analytics: merchant_analytics
[2025-10-17 19:51:47,259] INFO - ğŸ”„ Running database migrations...
[2025-10-17 19:51:47,259] INFO -    Checking for store_url column...
[2025-10-17 19:51:47,259] WARNING - âš ï¸ Migration warning (may be already applied): no such table: information_schema.columns
[2025-10-17 19:51:47,259] INFO - ğŸ”Œ Initializing optional services...
[2025-10-17 19:51:47,259] INFO - âœ… All services initialized successfully!
[2025-10-17 19:51:47,259] INFO - ğŸš€ Application startup complete!
[2025-10-17 19:51:47,259] INFO - ================================================================================
INFO:     Application startup complete.
WARNING:  WatchFiles detected changes in 'main.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
[2025-10-17 19:52:45,384] INFO - Database disconnected
[2025-10-17 19:52:45,385] INFO - ğŸ›‘ Application shutdown complete
INFO:     Application shutdown complete.
INFO:     Finished server process [32567]
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/multiprocessing/spawn.py", line 116, in spawn_main
    exitcode = _main(fd, parent_sentinel)
  File "/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/multiprocessing/spawn.py", line 125, in _main
    prepare(preparation_data)
  File "/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/multiprocessing/spawn.py", line 236, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/multiprocessing/spawn.py", line 287, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
  File "/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/runpy.py", line 268, in run_path
    return _run_module_code(code, init_globals, run_name,
  File "/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/runpy.py", line 97, in _run_module_code
    _run_code(code, mod_globals, init_globals,
  File "/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/runpy.py", line 87, in _run_code
    exec(code, run_globals)
  File "/Users/pengchydan/Desktop/Pivota Infra/Pivota-cursor-create-project-directory-structure-8344/pivota_infra/main.py", line 43, in <module>
    from routes.agent_api import router as agent_api_router
  File "/Users/pengchydan/Desktop/Pivota Infra/Pivota-cursor-create-project-directory-structure-8344/pivota_infra/routes/agent_api.py", line 17, in <module>
    from routes.order_routes import create_order_endpoint
ImportError: cannot import name 'create_order_endpoint' from 'routes.order_routes' (/Users/pengchydan/Desktop/Pivota Infra/Pivota-cursor-create-project-directory-structure-8344/pivota_infra/routes/order_routes.py)
WARNING:  WatchFiles detected changes in 'main.py'. Reloading...
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/multiprocessing/spawn.py", line 116, in spawn_main
    exitcode = _main(fd, parent_sentinel)
  File "/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/multiprocessing/spawn.py", line 125, in _main
    prepare(preparation_data)
  File "/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/multiprocessing/spawn.py", line 236, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/multiprocessing/spawn.py", line 287, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
  File "/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/runpy.py", line 268, in run_path
    return _run_module_code(code, init_globals, run_name,
  File "/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/runpy.py", line 97, in _run_module_code
    _run_code(code, mod_globals, init_globals,
  File "/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/runpy.py", line 87, in _run_code
    exec(code, run_globals)
  File "/Users/pengchydan/Desktop/Pivota Infra/Pivota-cursor-create-project-directory-structure-8344/pivota_infra/main.py", line 43, in <module>
    from routes.agent_api import router as agent_api_router
  File "/Users/pengchydan/Desktop/Pivota Infra/Pivota-cursor-create-project-directory-structure-8344/pivota_infra/routes/agent_api.py", line 17, in <module>
    from routes.order_routes import create_order_endpoint
ImportError: cannot import name 'create_order_endpoint' from 'routes.order_routes' (/Users/pengchydan/Desktop/Pivota Infra/Pivota-cursor-create-project-directory-structure-8344/pivota_infra/routes/order_routes.py)
WARNING:  WatchFiles detected changes in 'main.py'. Reloading...
WARNING:  WatchFiles detected changes in 'main.py'. Reloading...
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/multiprocessing/spawn.py", line 116, in spawn_main
    exitcode = _main(fd, parent_sentinel)
  File "/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/multiprocessing/spawn.py", line 125, in _main
    prepare(preparation_data)
  File "/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/multiprocessing/spawn.py", line 236, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/multiprocessing/spawn.py", line 287, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
  File "/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/runpy.py", line 268, in run_path
    return _run_module_code(code, init_globals, run_name,
  File "/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/runpy.py", line 97, in _run_module_code
    _run_code(code, mod_globals, init_globals,
  File "/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/runpy.py", line 87, in _run_code
    exec(code, run_globals)
  File "/Users/pengchydan/Desktop/Pivota Infra/Pivota-cursor-create-project-directory-structure-8344/pivota_infra/main.py", line 43, in <module>
    from routes.agent_api import router as agent_api_router
  File "/Users/pengchydan/Desktop/Pivota Infra/Pivota-cursor-create-project-directory-structure-8344/pivota_infra/routes/agent_api.py", line 17, in <module>
    from routes.order_routes import create_order_endpoint
ImportError: cannot import name 'create_order_endpoint' from 'routes.order_routes' (/Users/pengchydan/Desktop/Pivota Infra/Pivota-cursor-create-project-directory-structure-8344/pivota_infra/routes/order_routes.py)
WARNING:  WatchFiles detected changes in 'main.py'. Reloading...
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/multiprocessing/spawn.py", line 116, in spawn_main
    exitcode = _main(fd, parent_sentinel)
  File "/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/multiprocessing/spawn.py", line 125, in _main
    prepare(preparation_data)
  File "/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/multiprocessing/spawn.py", line 236, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/multiprocessing/spawn.py", line 287, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
  File "/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/runpy.py", line 268, in run_path
    return _run_module_code(code, init_globals, run_name,
  File "/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/runpy.py", line 97, in _run_module_code
    _run_code(code, mod_globals, init_globals,
  File "/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/runpy.py", line 87, in _run_code
    exec(code, run_globals)
  File "/Users/pengchydan/Desktop/Pivota Infra/Pivota-cursor-create-project-directory-structure-8344/pivota_infra/main.py", line 43, in <module>
    from routes.agent_api import router as agent_api_router
  File "/Users/pengchydan/Desktop/Pivota Infra/Pivota-cursor-create-project-directory-structure-8344/pivota_infra/routes/agent_api.py", line 17, in <module>
    from routes.order_routes import create_order_endpoint
ImportError: cannot import name 'create_order_endpoint' from 'routes.order_routes' (/Users/pengchydan/Desktop/Pivota Infra/Pivota-cursor-create-project-directory-structure-8344/pivota_infra/routes/order_routes.py)
WARNING:  WatchFiles detected changes in 'main.py'. Reloading...
WARNING:  WatchFiles detected changes in 'main.py'. Reloading...
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/multiprocessing/spawn.py", line 116, in spawn_main
    exitcode = _main(fd, parent_sentinel)
  File "/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/multiprocessing/spawn.py", line 125, in _main
    prepare(preparation_data)
  File "/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/multiprocessing/spawn.py", line 236, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/multiprocessing/spawn.py", line 287, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
  File "/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/runpy.py", line 268, in run_path
    return _run_module_code(code, init_globals, run_name,
  File "/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/runpy.py", line 97, in _run_module_code
    _run_code(code, mod_globals, init_globals,
  File "/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/runpy.py", line 87, in _run_code
    exec(code, run_globals)
  File "/Users/pengchydan/Desktop/Pivota Infra/Pivota-cursor-create-project-directory-structure-8344/pivota_infra/main.py", line 43, in <module>
    from routes.agent_api import router as agent_api_router
  File "/Users/pengchydan/Desktop/Pivota Infra/Pivota-cursor-create-project-directory-structure-8344/pivota_infra/routes/agent_api.py", line 17, in <module>
    from routes.order_routes import create_order_endpoint
ImportError: cannot import name 'create_order_endpoint' from 'routes.order_routes' (/Users/pengchydan/Desktop/Pivota Infra/Pivota-cursor-create-project-directory-structure-8344/pivota_infra/routes/order_routes.py)
WARNING:  WatchFiles detected changes in 'main.py'. Reloading...
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/multiprocessing/spawn.py", line 116, in spawn_main
    exitcode = _main(fd, parent_sentinel)
  File "/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/multiprocessing/spawn.py", line 125, in _main
    prepare(preparation_data)
  File "/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/multiprocessing/spawn.py", line 236, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/multiprocessing/spawn.py", line 287, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
  File "/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/runpy.py", line 268, in run_path
    return _run_module_code(code, init_globals, run_name,
  File "/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/runpy.py", line 97, in _run_module_code
    _run_code(code, mod_globals, init_globals,
  File "/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/runpy.py", line 87, in _run_code
    exec(code, run_globals)
  File "/Users/pengchydan/Desktop/Pivota Infra/Pivota-cursor-create-project-directory-structure-8344/pivota_infra/main.py", line 43, in <module>
    from routes.agent_api import router as agent_api_router
  File "/Users/pengchydan/Desktop/Pivota Infra/Pivota-cursor-create-project-directory-structure-8344/pivota_infra/routes/agent_api.py", line 17, in <module>
    from routes.order_routes import create_order_endpoint
ImportError: cannot import name 'create_order_endpoint' from 'routes.order_routes' (/Users/pengchydan/Desktop/Pivota Infra/Pivota-cursor-create-project-directory-structure-8344/pivota_infra/routes/order_routes.py)
WARNING:  WatchFiles detected changes in 'main.py'. Reloading...
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/multiprocessing/spawn.py", line 116, in spawn_main
    exitcode = _main(fd, parent_sentinel)
  File "/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/multiprocessing/spawn.py", line 125, in _main
    prepare(preparation_data)
  File "/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/multiprocessing/spawn.py", line 236, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/multiprocessing/spawn.py", line 287, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
  File "/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/runpy.py", line 268, in run_path
    return _run_module_code(code, init_globals, run_name,
  File "/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/runpy.py", line 97, in _run_module_code
    _run_code(code, mod_globals, init_globals,
  File "/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/runpy.py", line 87, in _run_code
    exec(code, run_globals)
  File "/Users/pengchydan/Desktop/Pivota Infra/Pivota-cursor-create-project-directory-structure-8344/pivota_infra/main.py", line 43, in <module>
    from routes.agent_api import router as agent_api_router
  File "/Users/pengchydan/Desktop/Pivota Infra/Pivota-cursor-create-project-directory-structure-8344/pivota_infra/routes/agent_api.py", line 17, in <module>
    from routes.order_routes import create_order_endpoint
ImportError: cannot import name 'create_order_endpoint' from 'routes.order_routes' (/Users/pengchydan/Desktop/Pivota Infra/Pivota-cursor-create-project-directory-structure-8344/pivota_infra/routes/order_routes.py)
WARNING:  WatchFiles detected changes in 'main.py'. Reloading...
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/multiprocessing/spawn.py", line 116, in spawn_main
    exitcode = _main(fd, parent_sentinel)
  File "/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/multiprocessing/spawn.py", line 125, in _main
    prepare(preparation_data)
  File "/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/multiprocessing/spawn.py", line 236, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/multiprocessing/spawn.py", line 287, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
  File "/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/runpy.py", line 268, in run_path
    return _run_module_code(code, init_globals, run_name,
  File "/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/runpy.py", line 97, in _run_module_code
    _run_code(code, mod_globals, init_globals,
  File "/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/runpy.py", line 87, in _run_code
    exec(code, run_globals)
  File "/Users/pengchydan/Desktop/Pivota Infra/Pivota-cursor-create-project-directory-structure-8344/pivota_infra/main.py", line 43, in <module>
    from routes.agent_api import router as agent_api_router
  File "/Users/pengchydan/Desktop/Pivota Infra/Pivota-cursor-create-project-directory-structure-8344/pivota_infra/routes/agent_api.py", line 17, in <module>
    from routes.order_routes import create_order_endpoint
ImportError: cannot import name 'create_order_endpoint' from 'routes.order_routes' (/Users/pengchydan/Desktop/Pivota Infra/Pivota-cursor-create-project-directory-structure-8344/pivota_infra/routes/order_routes.py)
WARNING:  WatchFiles detected changes in 'routes/order_routes.py'. Reloading...
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/multiprocessing/spawn.py", line 116, in spawn_main
    exitcode = _main(fd, parent_sentinel)
  File "/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/multiprocessing/spawn.py", line 125, in _main
    prepare(preparation_data)
  File "/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/multiprocessing/spawn.py", line 236, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/multiprocessing/spawn.py", line 287, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
  File "/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/runpy.py", line 268, in run_path
    return _run_module_code(code, init_globals, run_name,
  File "/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/runpy.py", line 97, in _run_module_code
    _run_code(code, mod_globals, init_globals,
  File "/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/runpy.py", line 87, in _run_code
    exec(code, run_globals)
  File "/Users/pengchydan/Desktop/Pivota Infra/Pivota-cursor-create-project-directory-structure-8344/pivota_infra/main.py", line 43, in <module>
    from routes.agent_api import router as agent_api_router
  File "/Users/pengchydan/Desktop/Pivota Infra/Pivota-cursor-create-project-directory-structure-8344/pivota_infra/routes/agent_api.py", line 17, in <module>
    from routes.order_routes import create_order_endpoint
ImportError: cannot import name 'create_order_endpoint' from 'routes.order_routes' (/Users/pengchydan/Desktop/Pivota Infra/Pivota-cursor-create-project-directory-structure-8344/pivota_infra/routes/order_routes.py)
WARNING:  WatchFiles detected changes in 'routes/order_routes.py'. Reloading...
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/multiprocessing/spawn.py", line 116, in spawn_main
    exitcode = _main(fd, parent_sentinel)
  File "/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/multiprocessing/spawn.py", line 125, in _main
    prepare(preparation_data)
  File "/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/multiprocessing/spawn.py", line 236, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/multiprocessing/spawn.py", line 287, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
  File "/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/runpy.py", line 268, in run_path
    return _run_module_code(code, init_globals, run_name,
  File "/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/runpy.py", line 97, in _run_module_code
    _run_code(code, mod_globals, init_globals,
  File "/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/runpy.py", line 87, in _run_code
    exec(code, run_globals)
  File "/Users/pengchydan/Desktop/Pivota Infra/Pivota-cursor-create-project-directory-structure-8344/pivota_infra/main.py", line 43, in <module>
    from routes.agent_api import router as agent_api_router
  File "/Users/pengchydan/Desktop/Pivota Infra/Pivota-cursor-create-project-directory-structure-8344/pivota_infra/routes/agent_api.py", line 17, in <module>
    from routes.order_routes import create_order_endpoint
ImportError: cannot import name 'create_order_endpoint' from 'routes.order_routes' (/Users/pengchydan/Desktop/Pivota Infra/Pivota-cursor-create-project-directory-structure-8344/pivota_infra/routes/order_routes.py)
WARNING:  WatchFiles detected changes in 'routes/agent_api.py'. Reloading...
[2025-10-17 20:50:19,204] INFO - âœ… MCP router included
[2025-10-17 20:50:19,207] INFO - âœ… Operations router included
[2025-10-17 20:50:19,282] INFO - âœ… MCP router included
[2025-10-17 20:50:19,286] INFO - âœ… Operations router included
INFO:     Started server process [34527]
INFO:     Waiting for application startup.
[2025-10-17 20:50:19,286] INFO - ğŸš€ Starting Pivota Infrastructure Dashboard...
[2025-10-17 20:50:19,286] INFO - ğŸ“¡ Connecting to database...
[2025-10-17 20:50:19,286] INFO -    Database URL type: <class 'databases.core.DatabaseURL'>
[2025-10-17 20:50:19,286] INFO -    Database driver: sqlite
[2025-10-17 20:50:19,286] INFO - âœ… Database connected successfully
[2025-10-17 20:50:19,287] INFO - âœ… Database connection test passed
[2025-10-17 20:50:19,287] INFO - ğŸ“‹ Creating tables...
[2025-10-17 20:50:19,293] INFO - âœ… Tables created:
[2025-10-17 20:50:19,293] INFO -    - Core: merchants, kyb_documents, merchant_onboarding, payment_router_config, orders
[2025-10-17 20:50:19,293] INFO -    - Agents: agents, agent_usage_logs
[2025-10-17 20:50:19,293] INFO -    - Cache: products_cache
[2025-10-17 20:50:19,293] INFO -    - Events: api_call_events, order_events
[2025-10-17 20:50:19,293] INFO -    - Analytics: merchant_analytics
[2025-10-17 20:50:19,293] INFO - ğŸ”„ Running database migrations...
[2025-10-17 20:50:19,293] INFO -    Checking for store_url column...
[2025-10-17 20:50:19,294] WARNING - âš ï¸ Migration warning (may be already applied): no such table: information_schema.columns
[2025-10-17 20:50:19,294] INFO - ğŸ”Œ Initializing optional services...
[2025-10-17 20:50:19,294] INFO - âœ… All services initialized successfully!
[2025-10-17 20:50:19,294] INFO - ğŸš€ Application startup complete!
[2025-10-17 20:50:19,294] INFO - ================================================================================
INFO:     Application startup complete.
INFO:     127.0.0.1:51055 - "GET /auth/admin-token HTTP/1.1" 200 OK
INFO:     127.0.0.1:57587 - "GET /auth/admin-token HTTP/1.1" 200 OK
INFO:     127.0.0.1:58709 - "POST /orders/create HTTP/1.1" 404 Not Found
INFO:     127.0.0.1:58710 - "POST /orders/create HTTP/1.1" 404 Not Found
WARNING:  WatchFiles detected changes in 'routes/agent_api.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
[2025-10-17 20:50:31,574] INFO - Database disconnected
[2025-10-17 20:50:31,574] INFO - ğŸ›‘ Application shutdown complete
INFO:     Application shutdown complete.
INFO:     Finished server process [34527]
[2025-10-17 20:50:33,125] INFO - âœ… MCP router included
[2025-10-17 20:50:33,128] INFO - âœ… Operations router included
[2025-10-17 20:50:33,190] INFO - âœ… MCP router included
[2025-10-17 20:50:33,194] INFO - âœ… Operations router included
INFO:     Started server process [34555]
INFO:     Waiting for application startup.
[2025-10-17 20:50:33,195] INFO - ğŸš€ Starting Pivota Infrastructure Dashboard...
[2025-10-17 20:50:33,195] INFO - ğŸ“¡ Connecting to database...
[2025-10-17 20:50:33,195] INFO -    Database URL type: <class 'databases.core.DatabaseURL'>
[2025-10-17 20:50:33,195] INFO -    Database driver: sqlite
[2025-10-17 20:50:33,195] INFO - âœ… Database connected successfully
[2025-10-17 20:50:33,196] INFO - âœ… Database connection test passed
[2025-10-17 20:50:33,196] INFO - ğŸ“‹ Creating tables...
[2025-10-17 20:50:33,197] INFO - âœ… Tables created:
[2025-10-17 20:50:33,197] INFO -    - Core: merchants, kyb_documents, merchant_onboarding, payment_router_config, orders
[2025-10-17 20:50:33,197] INFO -    - Agents: agents, agent_usage_logs
[2025-10-17 20:50:33,197] INFO -    - Cache: products_cache
[2025-10-17 20:50:33,197] INFO -    - Events: api_call_events, order_events
[2025-10-17 20:50:33,198] INFO -    - Analytics: merchant_analytics
[2025-10-17 20:50:33,198] INFO - ğŸ”„ Running database migrations...
[2025-10-17 20:50:33,198] INFO -    Checking for store_url column...
[2025-10-17 20:50:33,198] WARNING - âš ï¸ Migration warning (may be already applied): no such table: information_schema.columns
[2025-10-17 20:50:33,199] INFO - ğŸ”Œ Initializing optional services...
[2025-10-17 20:50:33,199] INFO - âœ… All services initialized successfully!
[2025-10-17 20:50:33,199] INFO - ğŸš€ Application startup complete!
[2025-10-17 20:50:33,199] INFO - ================================================================================
INFO:     Application startup complete.
WARNING:  WatchFiles detected changes in 'routes/agent_api.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
[2025-10-17 20:50:37,544] INFO - Database disconnected
[2025-10-17 20:50:37,544] INFO - ğŸ›‘ Application shutdown complete
INFO:     Application shutdown complete.
INFO:     Finished server process [34555]
[2025-10-17 20:50:38,497] INFO - âœ… MCP router included
[2025-10-17 20:50:38,500] INFO - âœ… Operations router included
[2025-10-17 20:50:38,554] INFO - âœ… MCP router included
[2025-10-17 20:50:38,557] INFO - âœ… Operations router included
INFO:     Started server process [34565]
INFO:     Waiting for application startup.
[2025-10-17 20:50:38,558] INFO - ğŸš€ Starting Pivota Infrastructure Dashboard...
[2025-10-17 20:50:38,558] INFO - ğŸ“¡ Connecting to database...
[2025-10-17 20:50:38,558] INFO -    Database URL type: <class 'databases.core.DatabaseURL'>
[2025-10-17 20:50:38,558] INFO -    Database driver: sqlite
[2025-10-17 20:50:38,558] INFO - âœ… Database connected successfully
[2025-10-17 20:50:38,559] INFO - âœ… Database connection test passed
[2025-10-17 20:50:38,559] INFO - ğŸ“‹ Creating tables...
[2025-10-17 20:50:38,560] INFO - âœ… Tables created:
[2025-10-17 20:50:38,560] INFO -    - Core: merchants, kyb_documents, merchant_onboarding, payment_router_config, orders
[2025-10-17 20:50:38,560] INFO -    - Agents: agents, agent_usage_logs
[2025-10-17 20:50:38,560] INFO -    - Cache: products_cache
[2025-10-17 20:50:38,560] INFO -    - Events: api_call_events, order_events
[2025-10-17 20:50:38,560] INFO -    - Analytics: merchant_analytics
[2025-10-17 20:50:38,560] INFO - ğŸ”„ Running database migrations...
[2025-10-17 20:50:38,560] INFO -    Checking for store_url column...
[2025-10-17 20:50:38,561] WARNING - âš ï¸ Migration warning (may be already applied): no such table: information_schema.columns
[2025-10-17 20:50:38,561] INFO - ğŸ”Œ Initializing optional services...
[2025-10-17 20:50:38,561] INFO - âœ… All services initialized successfully!
[2025-10-17 20:50:38,561] INFO - ğŸš€ Application startup complete!
[2025-10-17 20:50:38,561] INFO - ================================================================================
INFO:     Application startup complete.
WARNING:  WatchFiles detected changes in 'routes/agent_api.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
[2025-10-17 20:50:51,620] INFO - Database disconnected
[2025-10-17 20:50:51,620] INFO - ğŸ›‘ Application shutdown complete
INFO:     Application shutdown complete.
INFO:     Finished server process [34565]
[2025-10-17 20:50:52,874] INFO - âœ… MCP router included
[2025-10-17 20:50:52,879] INFO - âœ… Operations router included
[2025-10-17 20:50:52,945] INFO - âœ… MCP router included
[2025-10-17 20:50:52,949] INFO - âœ… Operations router included
INFO:     Started server process [34638]
INFO:     Waiting for application startup.
[2025-10-17 20:50:52,950] INFO - ğŸš€ Starting Pivota Infrastructure Dashboard...
[2025-10-17 20:50:52,950] INFO - ğŸ“¡ Connecting to database...
[2025-10-17 20:50:52,950] INFO -    Database URL type: <class 'databases.core.DatabaseURL'>
[2025-10-17 20:50:52,950] INFO -    Database driver: sqlite
[2025-10-17 20:50:52,950] INFO - âœ… Database connected successfully
[2025-10-17 20:50:52,951] INFO - âœ… Database connection test passed
[2025-10-17 20:50:52,951] INFO - ğŸ“‹ Creating tables...
[2025-10-17 20:50:52,952] INFO - âœ… Tables created:
[2025-10-17 20:50:52,952] INFO -    - Core: merchants, kyb_documents, merchant_onboarding, payment_router_config, orders
[2025-10-17 20:50:52,952] INFO -    - Agents: agents, agent_usage_logs
[2025-10-17 20:50:52,952] INFO -    - Cache: products_cache
[2025-10-17 20:50:52,952] INFO -    - Events: api_call_events, order_events
[2025-10-17 20:50:52,952] INFO -    - Analytics: merchant_analytics
[2025-10-17 20:50:52,952] INFO - ğŸ”„ Running database migrations...
[2025-10-17 20:50:52,952] INFO -    Checking for store_url column...
[2025-10-17 20:50:52,953] WARNING - âš ï¸ Migration warning (may be already applied): no such table: information_schema.columns
[2025-10-17 20:50:52,953] INFO - ğŸ”Œ Initializing optional services...
[2025-10-17 20:50:52,953] INFO - âœ… All services initialized successfully!
[2025-10-17 20:50:52,953] INFO - ğŸš€ Application startup complete!
[2025-10-17 20:50:52,953] INFO - ================================================================================
INFO:     Application startup complete.
WARNING:  WatchFiles detected changes in 'db/agents.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
[2025-10-17 20:58:52,145] INFO - Database disconnected
[2025-10-17 20:58:52,145] INFO - ğŸ›‘ Application shutdown complete
INFO:     Application shutdown complete.
INFO:     Finished server process [34638]
[2025-10-17 20:58:53,530] INFO - âœ… MCP router included
[2025-10-17 20:58:53,534] INFO - âœ… Operations router included
[2025-10-17 20:58:53,598] INFO - âœ… MCP router included
[2025-10-17 20:58:53,602] INFO - âœ… Operations router included
INFO:     Started server process [35031]
INFO:     Waiting for application startup.
[2025-10-17 20:58:53,603] INFO - ğŸš€ Starting Pivota Infrastructure Dashboard...
[2025-10-17 20:58:53,603] INFO - ğŸ“¡ Connecting to database...
[2025-10-17 20:58:53,603] INFO -    Database URL type: <class 'databases.core.DatabaseURL'>
[2025-10-17 20:58:53,603] INFO -    Database driver: sqlite
[2025-10-17 20:58:53,603] INFO - âœ… Database connected successfully
[2025-10-17 20:58:53,604] INFO - âœ… Database connection test passed
[2025-10-17 20:58:53,604] INFO - ğŸ“‹ Creating tables...
[2025-10-17 20:58:53,604] INFO - âœ… Tables created:
[2025-10-17 20:58:53,605] INFO -    - Core: merchants, kyb_documents, merchant_onboarding, payment_router_config, orders
[2025-10-17 20:58:53,605] INFO -    - Agents: agents, agent_usage_logs
[2025-10-17 20:58:53,605] INFO -    - Cache: products_cache
[2025-10-17 20:58:53,605] INFO -    - Events: api_call_events, order_events
[2025-10-17 20:58:53,605] INFO -    - Analytics: merchant_analytics
[2025-10-17 20:58:53,605] INFO - ğŸ”„ Running database migrations...
[2025-10-17 20:58:53,605] INFO -    Checking for store_url column...
[2025-10-17 20:58:53,606] WARNING - âš ï¸ Migration warning (may be already applied): no such table: information_schema.columns
[2025-10-17 20:58:53,606] INFO - ğŸ”Œ Initializing optional services...
[2025-10-17 20:58:53,606] INFO - âœ… All services initialized successfully!
[2025-10-17 20:58:53,606] INFO - ğŸš€ Application startup complete!
[2025-10-17 20:58:53,606] INFO - ================================================================================
INFO:     Application startup complete.
WARNING:  WatchFiles detected changes in 'db/agents.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
[2025-10-17 20:59:07,372] INFO - Database disconnected
[2025-10-17 20:59:07,373] INFO - ğŸ›‘ Application shutdown complete
INFO:     Application shutdown complete.
INFO:     Finished server process [35031]
[2025-10-17 20:59:08,892] INFO - âœ… MCP router included
[2025-10-17 20:59:08,895] INFO - âœ… Operations router included
[2025-10-17 20:59:08,956] INFO - âœ… MCP router included
[2025-10-17 20:59:08,960] INFO - âœ… Operations router included
INFO:     Started server process [35102]
INFO:     Waiting for application startup.
[2025-10-17 20:59:08,961] INFO - ğŸš€ Starting Pivota Infrastructure Dashboard...
[2025-10-17 20:59:08,961] INFO - ğŸ“¡ Connecting to database...
[2025-10-17 20:59:08,961] INFO -    Database URL type: <class 'databases.core.DatabaseURL'>
[2025-10-17 20:59:08,961] INFO -    Database driver: sqlite
[2025-10-17 20:59:08,961] INFO - âœ… Database connected successfully
[2025-10-17 20:59:08,962] INFO - âœ… Database connection test passed
[2025-10-17 20:59:08,962] INFO - ğŸ“‹ Creating tables...
[2025-10-17 20:59:08,963] INFO - âœ… Tables created:
[2025-10-17 20:59:08,963] INFO -    - Core: merchants, kyb_documents, merchant_onboarding, payment_router_config, orders
[2025-10-17 20:59:08,963] INFO -    - Agents: agents, agent_usage_logs
[2025-10-17 20:59:08,963] INFO -    - Cache: products_cache
[2025-10-17 20:59:08,963] INFO -    - Events: api_call_events, order_events
[2025-10-17 20:59:08,963] INFO -    - Analytics: merchant_analytics
[2025-10-17 20:59:08,963] INFO - ğŸ”„ Running database migrations...
[2025-10-17 20:59:08,963] INFO -    Checking for store_url column...
[2025-10-17 20:59:08,963] WARNING - âš ï¸ Migration warning (may be already applied): no such table: information_schema.columns
[2025-10-17 20:59:08,963] INFO - ğŸ”Œ Initializing optional services...
[2025-10-17 20:59:08,963] INFO - âœ… All services initialized successfully!
[2025-10-17 20:59:08,963] INFO - ğŸš€ Application startup complete!
[2025-10-17 20:59:08,963] INFO - ================================================================================
INFO:     Application startup complete.
WARNING:  WatchFiles detected changes in 'main.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
[2025-10-17 21:17:56,125] INFO - Database disconnected
[2025-10-17 21:17:56,126] INFO - ğŸ›‘ Application shutdown complete
INFO:     Application shutdown complete.
INFO:     Finished server process [35102]
[2025-10-17 21:17:57,727] INFO - âœ… MCP router included
[2025-10-17 21:17:57,731] INFO - âœ… Operations router included
[2025-10-17 21:17:57,807] INFO - âœ… MCP router included
[2025-10-17 21:17:57,811] INFO - âœ… Operations router included
INFO:     Started server process [36050]
INFO:     Waiting for application startup.
[2025-10-17 21:17:57,812] INFO - ğŸš€ Starting Pivota Infrastructure Dashboard...
[2025-10-17 21:17:57,812] INFO - ğŸ“¡ Connecting to database...
[2025-10-17 21:17:57,812] INFO -    Database URL type: <class 'databases.core.DatabaseURL'>
[2025-10-17 21:17:57,812] INFO -    Database driver: sqlite
[2025-10-17 21:17:57,812] INFO - âœ… Database connected successfully
[2025-10-17 21:17:57,813] INFO - âœ… Database connection test passed
[2025-10-17 21:17:57,813] INFO - ğŸ“‹ Creating tables...
[2025-10-17 21:17:57,814] INFO - âœ… Tables created:
[2025-10-17 21:17:57,814] INFO -    - Core: merchants, kyb_documents, merchant_onboarding, payment_router_config, orders
[2025-10-17 21:17:57,814] INFO -    - Agents: agents, agent_usage_logs
[2025-10-17 21:17:57,814] INFO -    - Cache: products_cache
[2025-10-17 21:17:57,814] INFO -    - Events: api_call_events, order_events
[2025-10-17 21:17:57,814] INFO -    - Analytics: merchant_analytics
[2025-10-17 21:17:57,814] INFO - ğŸ”„ Running database migrations...
[2025-10-17 21:17:57,814] INFO -    Checking for store_url column...
[2025-10-17 21:17:57,815] WARNING - âš ï¸ Migration warning (may be already applied): no such table: information_schema.columns
[2025-10-17 21:17:57,815] INFO - ğŸ”Œ Initializing optional services...
[2025-10-17 21:17:57,815] INFO - âœ… All services initialized successfully!
[2025-10-17 21:17:57,815] INFO - ğŸš€ Application startup complete!
[2025-10-17 21:17:57,815] INFO - ================================================================================
INFO:     Application startup complete.
WARNING:  WatchFiles detected changes in 'main.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
[2025-10-17 21:18:16,238] INFO - Database disconnected
[2025-10-17 21:18:16,238] INFO - ğŸ›‘ Application shutdown complete
INFO:     Application shutdown complete.
INFO:     Finished server process [36050]
[2025-10-17 21:18:17,805] INFO - âœ… MCP router included
[2025-10-17 21:18:17,809] INFO - âœ… Operations router included
[2025-10-17 21:18:17,880] INFO - âœ… MCP router included
[2025-10-17 21:18:17,885] INFO - âœ… Operations router included
INFO:     Started server process [36085]
INFO:     Waiting for application startup.
[2025-10-17 21:18:17,887] INFO - ğŸš€ Starting Pivota Infrastructure Dashboard...
[2025-10-17 21:18:17,887] INFO - ğŸ“¡ Connecting to database...
[2025-10-17 21:18:17,887] INFO -    Database URL type: <class 'databases.core.DatabaseURL'>
[2025-10-17 21:18:17,887] INFO -    Database driver: sqlite
[2025-10-17 21:18:17,887] INFO - âœ… Database connected successfully
[2025-10-17 21:18:17,888] INFO - âœ… Database connection test passed
[2025-10-17 21:18:17,888] INFO - ğŸ“‹ Creating tables...
[2025-10-17 21:18:17,889] INFO - âœ… Tables created:
[2025-10-17 21:18:17,889] INFO -    - Core: merchants, kyb_documents, merchant_onboarding, payment_router_config, orders
[2025-10-17 21:18:17,889] INFO -    - Agents: agents, agent_usage_logs
[2025-10-17 21:18:17,889] INFO -    - Cache: products_cache
[2025-10-17 21:18:17,889] INFO -    - Events: api_call_events, order_events
[2025-10-17 21:18:17,889] INFO -    - Analytics: merchant_analytics
[2025-10-17 21:18:17,889] INFO - ğŸ”„ Running database migrations...
[2025-10-17 21:18:17,889] INFO -    Checking for store_url column...
[2025-10-17 21:18:17,890] WARNING - âš ï¸ Migration warning (may be already applied): no such table: information_schema.columns
[2025-10-17 21:18:17,890] INFO - ğŸ”Œ Initializing optional services...
[2025-10-17 21:18:17,890] INFO - âœ… All services initialized successfully!
[2025-10-17 21:18:17,890] INFO - ğŸš€ Application startup complete!
[2025-10-17 21:18:17,890] INFO - ================================================================================
INFO:     Application startup complete.
WARNING:  WatchFiles detected changes in 'routes/order_routes.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
[2025-10-17 21:33:22,329] INFO - Database disconnected
[2025-10-17 21:33:22,330] INFO - ğŸ›‘ Application shutdown complete
INFO:     Application shutdown complete.
INFO:     Finished server process [36085]
[2025-10-17 21:33:23,687] INFO - âœ… MCP router included
[2025-10-17 21:33:23,690] INFO - âœ… Operations router included
[2025-10-17 21:33:23,755] INFO - âœ… MCP router included
[2025-10-17 21:33:23,759] INFO - âœ… Operations router included
INFO:     Started server process [36508]
INFO:     Waiting for application startup.
[2025-10-17 21:33:23,759] INFO - ğŸš€ Starting Pivota Infrastructure Dashboard...
[2025-10-17 21:33:23,760] INFO - ğŸ“¡ Connecting to database...
[2025-10-17 21:33:23,760] INFO -    Database URL type: <class 'databases.core.DatabaseURL'>
[2025-10-17 21:33:23,760] INFO -    Database driver: sqlite
[2025-10-17 21:33:23,760] INFO - âœ… Database connected successfully
[2025-10-17 21:33:23,760] INFO - âœ… Database connection test passed
[2025-10-17 21:33:23,760] INFO - ğŸ“‹ Creating tables...
[2025-10-17 21:33:23,761] INFO - âœ… Tables created:
[2025-10-17 21:33:23,761] INFO -    - Core: merchants, kyb_documents, merchant_onboarding, payment_router_config, orders
[2025-10-17 21:33:23,761] INFO -    - Agents: agents, agent_usage_logs
[2025-10-17 21:33:23,761] INFO -    - Cache: products_cache
[2025-10-17 21:33:23,761] INFO -    - Events: api_call_events, order_events
[2025-10-17 21:33:23,761] INFO -    - Analytics: merchant_analytics
[2025-10-17 21:33:23,761] INFO - ğŸ”„ Running database migrations...
[2025-10-17 21:33:23,761] INFO -    Checking for store_url column...
[2025-10-17 21:33:23,762] WARNING - âš ï¸ Migration warning (may be already applied): no such table: information_schema.columns
[2025-10-17 21:33:23,762] INFO - ğŸ”Œ Initializing optional services...
[2025-10-17 21:33:23,762] INFO - âœ… All services initialized successfully!
[2025-10-17 21:33:23,762] INFO - ğŸš€ Application startup complete!
[2025-10-17 21:33:23,762] INFO - ================================================================================
INFO:     Application startup complete.
WARNING:  WatchFiles detected changes in 'routes/order_routes.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
[2025-10-17 21:33:40,937] INFO - Database disconnected
[2025-10-17 21:33:40,937] INFO - ğŸ›‘ Application shutdown complete
INFO:     Application shutdown complete.
INFO:     Finished server process [36508]
[2025-10-17 21:33:42,330] INFO - âœ… MCP router included
[2025-10-17 21:33:42,334] INFO - âœ… Operations router included
[2025-10-17 21:33:42,410] INFO - âœ… MCP router included
[2025-10-17 21:33:42,414] INFO - âœ… Operations router included
INFO:     Started server process [36525]
INFO:     Waiting for application startup.
[2025-10-17 21:33:42,415] INFO - ğŸš€ Starting Pivota Infrastructure Dashboard...
[2025-10-17 21:33:42,415] INFO - ğŸ“¡ Connecting to database...
[2025-10-17 21:33:42,415] INFO -    Database URL type: <class 'databases.core.DatabaseURL'>
[2025-10-17 21:33:42,415] INFO -    Database driver: sqlite
[2025-10-17 21:33:42,415] INFO - âœ… Database connected successfully
[2025-10-17 21:33:42,417] INFO - âœ… Database connection test passed
[2025-10-17 21:33:42,417] INFO - ğŸ“‹ Creating tables...
[2025-10-17 21:33:42,418] INFO - âœ… Tables created:
[2025-10-17 21:33:42,418] INFO -    - Core: merchants, kyb_documents, merchant_onboarding, payment_router_config, orders
[2025-10-17 21:33:42,418] INFO -    - Agents: agents, agent_usage_logs
[2025-10-17 21:33:42,418] INFO -    - Cache: products_cache
[2025-10-17 21:33:42,418] INFO -    - Events: api_call_events, order_events
[2025-10-17 21:33:42,418] INFO -    - Analytics: merchant_analytics
[2025-10-17 21:33:42,418] INFO - ğŸ”„ Running database migrations...
[2025-10-17 21:33:42,418] INFO -    Checking for store_url column...
[2025-10-17 21:33:42,418] WARNING - âš ï¸ Migration warning (may be already applied): no such table: information_schema.columns
[2025-10-17 21:33:42,418] INFO - ğŸ”Œ Initializing optional services...
[2025-10-17 21:33:42,418] INFO - âœ… All services initialized successfully!
[2025-10-17 21:33:42,418] INFO - ğŸš€ Application startup complete!
[2025-10-17 21:33:42,419] INFO - ================================================================================
INFO:     Application startup complete.
WARNING:  WatchFiles detected changes in 'routes/order_routes.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
[2025-10-17 21:33:52,633] INFO - Database disconnected
[2025-10-17 21:33:52,633] INFO - ğŸ›‘ Application shutdown complete
INFO:     Application shutdown complete.
INFO:     Finished server process [36525]
[2025-10-17 21:33:53,904] INFO - âœ… MCP router included
[2025-10-17 21:33:53,908] INFO - âœ… Operations router included
[2025-10-17 21:33:53,970] INFO - âœ… MCP router included
[2025-10-17 21:33:53,974] INFO - âœ… Operations router included
INFO:     Started server process [36533]
INFO:     Waiting for application startup.
[2025-10-17 21:33:53,975] INFO - ğŸš€ Starting Pivota Infrastructure Dashboard...
[2025-10-17 21:33:53,975] INFO - ğŸ“¡ Connecting to database...
[2025-10-17 21:33:53,975] INFO -    Database URL type: <class 'databases.core.DatabaseURL'>
[2025-10-17 21:33:53,975] INFO -    Database driver: sqlite
[2025-10-17 21:33:53,975] INFO - âœ… Database connected successfully
[2025-10-17 21:33:53,976] INFO - âœ… Database connection test passed
[2025-10-17 21:33:53,976] INFO - ğŸ“‹ Creating tables...
[2025-10-17 21:33:53,978] INFO - âœ… Tables created:
[2025-10-17 21:33:53,978] INFO -    - Core: merchants, kyb_documents, merchant_onboarding, payment_router_config, orders
[2025-10-17 21:33:53,978] INFO -    - Agents: agents, agent_usage_logs
[2025-10-17 21:33:53,978] INFO -    - Cache: products_cache
[2025-10-17 21:33:53,978] INFO -    - Events: api_call_events, order_events
[2025-10-17 21:33:53,978] INFO -    - Analytics: merchant_analytics
[2025-10-17 21:33:53,978] INFO - ğŸ”„ Running database migrations...
[2025-10-17 21:33:53,978] INFO -    Checking for store_url column...
[2025-10-17 21:33:53,979] WARNING - âš ï¸ Migration warning (may be already applied): no such table: information_schema.columns
[2025-10-17 21:33:53,979] INFO - ğŸ”Œ Initializing optional services...
[2025-10-17 21:33:53,979] INFO - âœ… All services initialized successfully!
[2025-10-17 21:33:53,979] INFO - ğŸš€ Application startup complete!
[2025-10-17 21:33:53,979] INFO - ================================================================================
INFO:     Application startup complete.
WARNING:  WatchFiles detected changes in 'routes/order_routes.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
[2025-10-17 21:34:04,898] INFO - Database disconnected
[2025-10-17 21:34:04,898] INFO - ğŸ›‘ Application shutdown complete
INFO:     Application shutdown complete.
INFO:     Finished server process [36533]
[2025-10-17 21:34:06,407] INFO - âœ… MCP router included
[2025-10-17 21:34:06,415] INFO - âœ… Operations router included
[2025-10-17 21:34:06,515] INFO - âœ… MCP router included
[2025-10-17 21:34:06,520] INFO - âœ… Operations router included
INFO:     Started server process [36557]
INFO:     Waiting for application startup.
[2025-10-17 21:34:06,521] INFO - ğŸš€ Starting Pivota Infrastructure Dashboard...
[2025-10-17 21:34:06,521] INFO - ğŸ“¡ Connecting to database...
[2025-10-17 21:34:06,521] INFO -    Database URL type: <class 'databases.core.DatabaseURL'>
[2025-10-17 21:34:06,521] INFO -    Database driver: sqlite
[2025-10-17 21:34:06,521] INFO - âœ… Database connected successfully
[2025-10-17 21:34:06,522] INFO - âœ… Database connection test passed
[2025-10-17 21:34:06,522] INFO - ğŸ“‹ Creating tables...
[2025-10-17 21:34:06,522] INFO - âœ… Tables created:
[2025-10-17 21:34:06,522] INFO -    - Core: merchants, kyb_documents, merchant_onboarding, payment_router_config, orders
[2025-10-17 21:34:06,522] INFO -    - Agents: agents, agent_usage_logs
[2025-10-17 21:34:06,523] INFO -    - Cache: products_cache
[2025-10-17 21:34:06,523] INFO -    - Events: api_call_events, order_events
[2025-10-17 21:34:06,523] INFO -    - Analytics: merchant_analytics
[2025-10-17 21:34:06,523] INFO - ğŸ”„ Running database migrations...
[2025-10-17 21:34:06,523] INFO -    Checking for store_url column...
[2025-10-17 21:34:06,523] WARNING - âš ï¸ Migration warning (may be already applied): no such table: information_schema.columns
[2025-10-17 21:34:06,523] INFO - ğŸ”Œ Initializing optional services...
[2025-10-17 21:34:06,523] INFO - âœ… All services initialized successfully!
[2025-10-17 21:34:06,523] INFO - ğŸš€ Application startup complete!
[2025-10-17 21:34:06,523] INFO - ================================================================================
INFO:     Application startup complete.
WARNING:  WatchFiles detected changes in 'routes/order_routes.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
[2025-10-17 21:40:10,875] INFO - Database disconnected
[2025-10-17 21:40:10,875] INFO - ğŸ›‘ Application shutdown complete
INFO:     Application shutdown complete.
INFO:     Finished server process [36557]
[2025-10-17 21:40:14,495] INFO - âœ… MCP router included
[2025-10-17 21:40:14,499] INFO - âœ… Operations router included
[2025-10-17 21:40:14,645] INFO - âœ… MCP router included
[2025-10-17 21:40:14,649] INFO - âœ… Operations router included
INFO:     Started server process [36862]
INFO:     Waiting for application startup.
[2025-10-17 21:40:14,650] INFO - ğŸš€ Starting Pivota Infrastructure Dashboard...
[2025-10-17 21:40:14,650] INFO - ğŸ“¡ Connecting to database...
[2025-10-17 21:40:14,650] INFO -    Database URL type: <class 'databases.core.DatabaseURL'>
[2025-10-17 21:40:14,650] INFO -    Database driver: sqlite
[2025-10-17 21:40:14,650] INFO - âœ… Database connected successfully
[2025-10-17 21:40:14,651] INFO - âœ… Database connection test passed
[2025-10-17 21:40:14,651] INFO - ğŸ“‹ Creating tables...
[2025-10-17 21:40:14,652] INFO - âœ… Tables created:
[2025-10-17 21:40:14,652] INFO -    - Core: merchants, kyb_documents, merchant_onboarding, payment_router_config, orders
[2025-10-17 21:40:14,652] INFO -    - Agents: agents, agent_usage_logs
[2025-10-17 21:40:14,652] INFO -    - Cache: products_cache
[2025-10-17 21:40:14,652] INFO -    - Events: api_call_events, order_events
[2025-10-17 21:40:14,652] INFO -    - Analytics: merchant_analytics
[2025-10-17 21:40:14,652] INFO - ğŸ”„ Running database migrations...
[2025-10-17 21:40:14,652] INFO -    Checking for store_url column...
[2025-10-17 21:40:14,653] WARNING - âš ï¸ Migration warning (may be already applied): no such table: information_schema.columns
[2025-10-17 21:40:14,653] INFO - ğŸ”Œ Initializing optional services...
[2025-10-17 21:40:14,653] INFO - âœ… All services initialized successfully!
[2025-10-17 21:40:14,653] INFO - ğŸš€ Application startup complete!
[2025-10-17 21:40:14,653] INFO - ================================================================================
INFO:     Application startup complete.
WARNING:  WatchFiles detected changes in 'routes/order_routes.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
[2025-10-17 21:40:19,257] INFO - Database disconnected
[2025-10-17 21:40:19,257] INFO - ğŸ›‘ Application shutdown complete
INFO:     Application shutdown complete.
INFO:     Finished server process [36862]
[2025-10-17 21:40:20,261] INFO - âœ… MCP router included
[2025-10-17 21:40:20,264] INFO - âœ… Operations router included
[2025-10-17 21:40:20,321] INFO - âœ… MCP router included
[2025-10-17 21:40:20,324] INFO - âœ… Operations router included
INFO:     Started server process [36874]
INFO:     Waiting for application startup.
[2025-10-17 21:40:20,325] INFO - ğŸš€ Starting Pivota Infrastructure Dashboard...
[2025-10-17 21:40:20,325] INFO - ğŸ“¡ Connecting to database...
[2025-10-17 21:40:20,325] INFO -    Database URL type: <class 'databases.core.DatabaseURL'>
[2025-10-17 21:40:20,325] INFO -    Database driver: sqlite
[2025-10-17 21:40:20,325] INFO - âœ… Database connected successfully
[2025-10-17 21:40:20,326] INFO - âœ… Database connection test passed
[2025-10-17 21:40:20,326] INFO - ğŸ“‹ Creating tables...
[2025-10-17 21:40:20,327] INFO - âœ… Tables created:
[2025-10-17 21:40:20,327] INFO -    - Core: merchants, kyb_documents, merchant_onboarding, payment_router_config, orders
[2025-10-17 21:40:20,327] INFO -    - Agents: agents, agent_usage_logs
[2025-10-17 21:40:20,327] INFO -    - Cache: products_cache
[2025-10-17 21:40:20,327] INFO -    - Events: api_call_events, order_events
[2025-10-17 21:40:20,327] INFO -    - Analytics: merchant_analytics
[2025-10-17 21:40:20,327] INFO - ğŸ”„ Running database migrations...
[2025-10-17 21:40:20,327] INFO -    Checking for store_url column...
[2025-10-17 21:40:20,327] WARNING - âš ï¸ Migration warning (may be already applied): no such table: information_schema.columns
[2025-10-17 21:40:20,327] INFO - ğŸ”Œ Initializing optional services...
[2025-10-17 21:40:20,327] INFO - âœ… All services initialized successfully!
[2025-10-17 21:40:20,327] INFO - ğŸš€ Application startup complete!
[2025-10-17 21:40:20,327] INFO - ================================================================================
INFO:     Application startup complete.
WARNING:  WatchFiles detected changes in 'fix_database_tables.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
[2025-10-17 21:56:23,675] INFO - Database disconnected
[2025-10-17 21:56:23,675] INFO - ğŸ›‘ Application shutdown complete
INFO:     Application shutdown complete.
INFO:     Finished server process [36874]
WARNING:  WatchFiles detected changes in 'fix_database_tables.py'. Reloading...
WARNING:  WatchFiles detected changes in 'fix_database_tables.py'. Reloading...
[2025-10-17 21:56:25,984] INFO - âœ… MCP router included
[2025-10-17 21:56:25,988] INFO - âœ… Operations router included
[2025-10-17 21:56:26,069] INFO - âœ… MCP router included
[2025-10-17 21:56:26,072] INFO - âœ… Operations router included
INFO:     Started server process [37257]
INFO:     Waiting for application startup.
[2025-10-17 21:56:26,074] INFO - ğŸš€ Starting Pivota Infrastructure Dashboard...
[2025-10-17 21:56:26,074] INFO - ğŸ“¡ Connecting to database...
[2025-10-17 21:56:26,074] INFO -    Database URL type: <class 'databases.core.DatabaseURL'>
[2025-10-17 21:56:26,074] INFO -    Database driver: sqlite
[2025-10-17 21:56:26,074] INFO - âœ… Database connected successfully
[2025-10-17 21:56:26,076] INFO - âœ… Database connection test passed
[2025-10-17 21:56:26,076] INFO - ğŸ“‹ Creating tables...
[2025-10-17 21:56:26,078] INFO - âœ… Tables created:
[2025-10-17 21:56:26,078] INFO -    - Core: merchants, kyb_documents, merchant_onboarding, payment_router_config, orders
[2025-10-17 21:56:26,078] INFO -    - Agents: agents, agent_usage_logs
[2025-10-17 21:56:26,078] INFO -    - Cache: products_cache
[2025-10-17 21:56:26,078] INFO -    - Events: api_call_events, order_events
[2025-10-17 21:56:26,078] INFO -    - Analytics: merchant_analytics
[2025-10-17 21:56:26,078] INFO - ğŸ”„ Running database migrations...
[2025-10-17 21:56:26,079] INFO -    Checking for store_url column...
[2025-10-17 21:56:26,081] WARNING - âš ï¸ Migration warning (may be already applied): no such table: information_schema.columns
[2025-10-17 21:56:26,081] INFO - ğŸ”Œ Initializing optional services...
[2025-10-17 21:56:26,081] INFO - âœ… All services initialized successfully!
[2025-10-17 21:56:26,081] INFO - ğŸš€ Application startup complete!
[2025-10-17 21:56:26,081] INFO - ================================================================================
INFO:     Application startup complete.
WARNING:  WatchFiles detected changes in 'main.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
[2025-10-17 21:56:42,760] INFO - Database disconnected
[2025-10-17 21:56:42,761] INFO - ğŸ›‘ Application shutdown complete
INFO:     Application shutdown complete.
INFO:     Finished server process [37257]
[2025-10-17 21:56:44,131] INFO - âœ… MCP router included
[2025-10-17 21:56:44,134] INFO - âœ… Operations router included
[2025-10-17 21:56:44,201] INFO - âœ… MCP router included
[2025-10-17 21:56:44,205] INFO - âœ… Operations router included
INFO:     Started server process [37272]
INFO:     Waiting for application startup.
[2025-10-17 21:56:44,206] INFO - ğŸš€ Starting Pivota Infrastructure Dashboard...
[2025-10-17 21:56:44,206] INFO - ğŸ“¡ Connecting to database...
[2025-10-17 21:56:44,206] INFO -    Database URL type: <class 'databases.core.DatabaseURL'>
[2025-10-17 21:56:44,206] INFO -    Database driver: sqlite
[2025-10-17 21:56:44,206] INFO - âœ… Database connected successfully
[2025-10-17 21:56:44,206] ERROR - ================================================================================
[2025-10-17 21:56:44,206] ERROR - âŒ CRITICAL ERROR during startup: local variable 'metadata' referenced before assignment
[2025-10-17 21:56:44,206] ERROR - âŒ Error type: UnboundLocalError
[2025-10-17 21:56:44,206] ERROR - âŒ Error details: local variable 'metadata' referenced before assignment
[2025-10-17 21:56:44,206] ERROR - ================================================================================
Traceback (most recent call last):
  File "/Users/pengchydan/Desktop/Pivota Infra/Pivota-cursor-create-project-directory-structure-8344/pivota_infra/main.py", line 199, in startup
    metadata.create_all(engine)
UnboundLocalError: local variable 'metadata' referenced before assignment
[2025-10-17 21:56:44,207] ERROR - ğŸ›‘ Cannot continue without database connection
ERROR:    Traceback (most recent call last):
  File "/Users/pengchydan/Desktop/Pivota Infra/Pivota-cursor-create-project-directory-structure-8344/pivota_infra/main.py", line 199, in startup
    metadata.create_all(engine)
UnboundLocalError: local variable 'metadata' referenced before assignment

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/pengchydan/Library/Python/3.9/lib/python/site-packages/starlette/routing.py", line 694, in lifespan
    async with self.lifespan_context(app) as maybe_state:
  File "/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/contextlib.py", line 175, in __aenter__
    return await self.gen.__anext__()
  File "/Users/pengchydan/Library/Python/3.9/lib/python/site-packages/fastapi/routing.py", line 209, in merged_lifespan
    async with original_context(app) as maybe_original_state:
  File "/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/contextlib.py", line 175, in __aenter__
    return await self.gen.__anext__()
  File "/Users/pengchydan/Library/Python/3.9/lib/python/site-packages/fastapi/routing.py", line 209, in merged_lifespan
    async with original_context(app) as maybe_original_state:
  File "/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/contextlib.py", line 175, in __aenter__
    return await self.gen.__anext__()
  File "/Users/pengchydan/Library/Python/3.9/lib/python/site-packages/fastapi/routing.py", line 209, in merged_lifespan
    async with original_context(app) as maybe_original_state:
  File "/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/contextlib.py", line 175, in __aenter__
    return await self.gen.__anext__()
  File "/Users/pengchydan/Library/Python/3.9/lib/python/site-packages/fastapi/routing.py", line 209, in merged_lifespan
    async with original_context(app) as maybe_original_state:
  File "/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/contextlib.py", line 175, in __aenter__
    return await self.gen.__anext__()
  File "/Users/pengchydan/Library/Python/3.9/lib/python/site-packages/fastapi/routing.py", line 209, in merged_lifespan
    async with original_context(app) as maybe_original_state:
  File "/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/contextlib.py", line 175, in __aenter__
    return await self.gen.__anext__()
  File "/Users/pengchydan/Library/Python/3.9/lib/python/site-packages/fastapi/routing.py", line 209, in merged_lifespan
    async with original_context(app) as maybe_original_state:
  File "/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/contextlib.py", line 175, in __aenter__
    return await self.gen.__anext__()
  File "/Users/pengchydan/Library/Python/3.9/lib/python/site-packages/fastapi/routing.py", line 209, in merged_lifespan
    async with original_context(app) as maybe_original_state:
  File "/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/contextlib.py", line 175, in __aenter__
    return await self.gen.__anext__()
  File "/Users/pengchydan/Library/Python/3.9/lib/python/site-packages/fastapi/routing.py", line 209, in merged_lifespan
    async with original_context(app) as maybe_original_state:
  File "/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/contextlib.py", line 175, in __aenter__
    return await self.gen.__anext__()
  File "/Users/pengchydan/Library/Python/3.9/lib/python/site-packages/fastapi/routing.py", line 209, in merged_lifespan
    async with original_context(app) as maybe_original_state:
  File "/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/contextlib.py", line 175, in __aenter__
    return await self.gen.__anext__()
  File "/Users/pengchydan/Library/Python/3.9/lib/python/site-packages/fastapi/routing.py", line 209, in merged_lifespan
    async with original_context(app) as maybe_original_state:
  File "/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/contextlib.py", line 175, in __aenter__
    return await self.gen.__anext__()
  File "/Users/pengchydan/Library/Python/3.9/lib/python/site-packages/fastapi/routing.py", line 209, in merged_lifespan
    async with original_context(app) as maybe_original_state:
  File "/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/contextlib.py", line 175, in __aenter__
    return await self.gen.__anext__()
  File "/Users/pengchydan/Library/Python/3.9/lib/python/site-packages/fastapi/routing.py", line 209, in merged_lifespan
    async with original_context(app) as maybe_original_state:
  File "/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/contextlib.py", line 175, in __aenter__
    return await self.gen.__anext__()
  File "/Users/pengchydan/Library/Python/3.9/lib/python/site-packages/fastapi/routing.py", line 209, in merged_lifespan
    async with original_context(app) as maybe_original_state:
  File "/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/contextlib.py", line 175, in __aenter__
    return await self.gen.__anext__()
  File "/Users/pengchydan/Library/Python/3.9/lib/python/site-packages/fastapi/routing.py", line 209, in merged_lifespan
    async with original_context(app) as maybe_original_state:
  File "/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/contextlib.py", line 175, in __aenter__
    return await self.gen.__anext__()
  File "/Users/pengchydan/Library/Python/3.9/lib/python/site-packages/fastapi/routing.py", line 209, in merged_lifespan
    async with original_context(app) as maybe_original_state:
  File "/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/contextlib.py", line 175, in __aenter__
    return await self.gen.__anext__()
  File "/Users/pengchydan/Library/Python/3.9/lib/python/site-packages/fastapi/routing.py", line 209, in merged_lifespan
    async with original_context(app) as maybe_original_state:
  File "/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/contextlib.py", line 175, in __aenter__
    return await self.gen.__anext__()
  File "/Users/pengchydan/Library/Python/3.9/lib/python/site-packages/fastapi/routing.py", line 209, in merged_lifespan
    async with original_context(app) as maybe_original_state:
  File "/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/contextlib.py", line 175, in __aenter__
    return await self.gen.__anext__()
  File "/Users/pengchydan/Library/Python/3.9/lib/python/site-packages/fastapi/routing.py", line 209, in merged_lifespan
    async with original_context(app) as maybe_original_state:
  File "/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/contextlib.py", line 175, in __aenter__
    return await self.gen.__anext__()
  File "/Users/pengchydan/Library/Python/3.9/lib/python/site-packages/fastapi/routing.py", line 209, in merged_lifespan
    async with original_context(app) as maybe_original_state:
  File "/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/contextlib.py", line 175, in __aenter__
    return await self.gen.__anext__()
  File "/Users/pengchydan/Library/Python/3.9/lib/python/site-packages/fastapi/routing.py", line 209, in merged_lifespan
    async with original_context(app) as maybe_original_state:
  File "/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/contextlib.py", line 175, in __aenter__
    return await self.gen.__anext__()
  File "/Users/pengchydan/Library/Python/3.9/lib/python/site-packages/fastapi/routing.py", line 209, in merged_lifespan
    async with original_context(app) as maybe_original_state:
  File "/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/contextlib.py", line 175, in __aenter__
    return await self.gen.__anext__()
  File "/Users/pengchydan/Library/Python/3.9/lib/python/site-packages/fastapi/routing.py", line 209, in merged_lifespan
    async with original_context(app) as maybe_original_state:
  File "/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/contextlib.py", line 175, in __aenter__
    return await self.gen.__anext__()
  File "/Users/pengchydan/Library/Python/3.9/lib/python/site-packages/fastapi/routing.py", line 209, in merged_lifespan
    async with original_context(app) as maybe_original_state:
  File "/Users/pengchydan/Library/Python/3.9/lib/python/site-packages/starlette/routing.py", line 571, in __aenter__
    await self._router.startup()
  File "/Users/pengchydan/Library/Python/3.9/lib/python/site-packages/starlette/routing.py", line 671, in startup
    await handler()
  File "/Users/pengchydan/Desktop/Pivota Infra/Pivota-cursor-create-project-directory-structure-8344/pivota_infra/main.py", line 341, in startup
    raise RuntimeError(f"Database initialization failed: {e}") from e
RuntimeError: Database initialization failed: local variable 'metadata' referenced before assignment

ERROR:    Application startup failed. Exiting.
WARNING:  WatchFiles detected changes in 'fix_database_tables.py'. Reloading...
[2025-10-17 21:56:45,326] INFO - âœ… MCP router included
[2025-10-17 21:56:45,330] INFO - âœ… Operations router included
[2025-10-17 21:56:45,390] INFO - âœ… MCP router included
[2025-10-17 21:56:45,394] INFO - âœ… Operations router included
INFO:     Started server process [37283]
INFO:     Waiting for application startup.
[2025-10-17 21:56:45,395] INFO - ğŸš€ Starting Pivota Infrastructure Dashboard...
[2025-10-17 21:56:45,395] INFO - ğŸ“¡ Connecting to database...
[2025-10-17 21:56:45,396] INFO -    Database URL type: <class 'databases.core.DatabaseURL'>
[2025-10-17 21:56:45,396] INFO -    Database driver: sqlite
[2025-10-17 21:56:45,396] INFO - âœ… Database connected successfully
[2025-10-17 21:56:45,396] ERROR - ================================================================================
[2025-10-17 21:56:45,396] ERROR - âŒ CRITICAL ERROR during startup: local variable 'metadata' referenced before assignment
[2025-10-17 21:56:45,396] ERROR - âŒ Error type: UnboundLocalError
[2025-10-17 21:56:45,396] ERROR - âŒ Error details: local variable 'metadata' referenced before assignment
[2025-10-17 21:56:45,396] ERROR - ================================================================================
Traceback (most recent call last):
  File "/Users/pengchydan/Desktop/Pivota Infra/Pivota-cursor-create-project-directory-structure-8344/pivota_infra/main.py", line 199, in startup
    metadata.create_all(engine)
UnboundLocalError: local variable 'metadata' referenced before assignment
[2025-10-17 21:56:45,397] ERROR - ğŸ›‘ Cannot continue without database connection
ERROR:    Traceback (most recent call last):
  File "/Users/pengchydan/Desktop/Pivota Infra/Pivota-cursor-create-project-directory-structure-8344/pivota_infra/main.py", line 199, in startup
    metadata.create_all(engine)
UnboundLocalError: local variable 'metadata' referenced before assignment

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/pengchydan/Library/Python/3.9/lib/python/site-packages/starlette/routing.py", line 694, in lifespan
    async with self.lifespan_context(app) as maybe_state:
  File "/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/contextlib.py", line 175, in __aenter__
    return await self.gen.__anext__()
  File "/Users/pengchydan/Library/Python/3.9/lib/python/site-packages/fastapi/routing.py", line 209, in merged_lifespan
    async with original_context(app) as maybe_original_state:
  File "/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/contextlib.py", line 175, in __aenter__
    return await self.gen.__anext__()
  File "/Users/pengchydan/Library/Python/3.9/lib/python/site-packages/fastapi/routing.py", line 209, in merged_lifespan
    async with original_context(app) as maybe_original_state:
  File "/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/contextlib.py", line 175, in __aenter__
    return await self.gen.__anext__()
  File "/Users/pengchydan/Library/Python/3.9/lib/python/site-packages/fastapi/routing.py", line 209, in merged_lifespan
    async with original_context(app) as maybe_original_state:
  File "/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/contextlib.py", line 175, in __aenter__
    return await self.gen.__anext__()
  File "/Users/pengchydan/Library/Python/3.9/lib/python/site-packages/fastapi/routing.py", line 209, in merged_lifespan
    async with original_context(app) as maybe_original_state:
  File "/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/contextlib.py", line 175, in __aenter__
    return await self.gen.__anext__()
  File "/Users/pengchydan/Library/Python/3.9/lib/python/site-packages/fastapi/routing.py", line 209, in merged_lifespan
    async with original_context(app) as maybe_original_state:
  File "/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/contextlib.py", line 175, in __aenter__
    return await self.gen.__anext__()
  File "/Users/pengchydan/Library/Python/3.9/lib/python/site-packages/fastapi/routing.py", line 209, in merged_lifespan
    async with original_context(app) as maybe_original_state:
  File "/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/contextlib.py", line 175, in __aenter__
    return await self.gen.__anext__()
  File "/Users/pengchydan/Library/Python/3.9/lib/python/site-packages/fastapi/routing.py", line 209, in merged_lifespan
    async with original_context(app) as maybe_original_state:
  File "/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/contextlib.py", line 175, in __aenter__
    return await self.gen.__anext__()
  File "/Users/pengchydan/Library/Python/3.9/lib/python/site-packages/fastapi/routing.py", line 209, in merged_lifespan
    async with original_context(app) as maybe_original_state:
  File "/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/contextlib.py", line 175, in __aenter__
    return await self.gen.__anext__()
  File "/Users/pengchydan/Library/Python/3.9/lib/python/site-packages/fastapi/routing.py", line 209, in merged_lifespan
    async with original_context(app) as maybe_original_state:
  File "/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/contextlib.py", line 175, in __aenter__
    return await self.gen.__anext__()
  File "/Users/pengchydan/Library/Python/3.9/lib/python/site-packages/fastapi/routing.py", line 209, in merged_lifespan
    async with original_context(app) as maybe_original_state:
  File "/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/contextlib.py", line 175, in __aenter__
    return await self.gen.__anext__()
  File "/Users/pengchydan/Library/Python/3.9/lib/python/site-packages/fastapi/routing.py", line 209, in merged_lifespan
    async with original_context(app) as maybe_original_state:
  File "/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/contextlib.py", line 175, in __aenter__
    return await self.gen.__anext__()
  File "/Users/pengchydan/Library/Python/3.9/lib/python/site-packages/fastapi/routing.py", line 209, in merged_lifespan
    async with original_context(app) as maybe_original_state:
  File "/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/contextlib.py", line 175, in __aenter__
    return await self.gen.__anext__()
  File "/Users/pengchydan/Library/Python/3.9/lib/python/site-packages/fastapi/routing.py", line 209, in merged_lifespan
    async with original_context(app) as maybe_original_state:
  File "/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/contextlib.py", line 175, in __aenter__
    return await self.gen.__anext__()
  File "/Users/pengchydan/Library/Python/3.9/lib/python/site-packages/fastapi/routing.py", line 209, in merged_lifespan
    async with original_context(app) as maybe_original_state:
  File "/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/contextlib.py", line 175, in __aenter__
    return await self.gen.__anext__()
  File "/Users/pengchydan/Library/Python/3.9/lib/python/site-packages/fastapi/routing.py", line 209, in merged_lifespan
    async with original_context(app) as maybe_original_state:
  File "/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/contextlib.py", line 175, in __aenter__
    return await self.gen.__anext__()
  File "/Users/pengchydan/Library/Python/3.9/lib/python/site-packages/fastapi/routing.py", line 209, in merged_lifespan
    async with original_context(app) as maybe_original_state:
  File "/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/contextlib.py", line 175, in __aenter__
    return await self.gen.__anext__()
  File "/Users/pengchydan/Library/Python/3.9/lib/python/site-packages/fastapi/routing.py", line 209, in merged_lifespan
    async with original_context(app) as maybe_original_state:
  File "/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/contextlib.py", line 175, in __aenter__
    return await self.gen.__anext__()
  File "/Users/pengchydan/Library/Python/3.9/lib/python/site-packages/fastapi/routing.py", line 209, in merged_lifespan
    async with original_context(app) as maybe_original_state:
  File "/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/contextlib.py", line 175, in __aenter__
    return await self.gen.__anext__()
  File "/Users/pengchydan/Library/Python/3.9/lib/python/site-packages/fastapi/routing.py", line 209, in merged_lifespan
    async with original_context(app) as maybe_original_state:
  File "/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/contextlib.py", line 175, in __aenter__
    return await self.gen.__anext__()
  File "/Users/pengchydan/Library/Python/3.9/lib/python/site-packages/fastapi/routing.py", line 209, in merged_lifespan
    async with original_context(app) as maybe_original_state:
  File "/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/contextlib.py", line 175, in __aenter__
    return await self.gen.__anext__()
  File "/Users/pengchydan/Library/Python/3.9/lib/python/site-packages/fastapi/routing.py", line 209, in merged_lifespan
    async with original_context(app) as maybe_original_state:
  File "/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/contextlib.py", line 175, in __aenter__
    return await self.gen.__anext__()
  File "/Users/pengchydan/Library/Python/3.9/lib/python/site-packages/fastapi/routing.py", line 209, in merged_lifespan
    async with original_context(app) as maybe_original_state:
  File "/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/contextlib.py", line 175, in __aenter__
    return await self.gen.__anext__()
  File "/Users/pengchydan/Library/Python/3.9/lib/python/site-packages/fastapi/routing.py", line 209, in merged_lifespan
    async with original_context(app) as maybe_original_state:
  File "/Users/pengchydan/Library/Python/3.9/lib/python/site-packages/starlette/routing.py", line 571, in __aenter__
    await self._router.startup()
  File "/Users/pengchydan/Library/Python/3.9/lib/python/site-packages/starlette/routing.py", line 671, in startup
    await handler()
  File "/Users/pengchydan/Desktop/Pivota Infra/Pivota-cursor-create-project-directory-structure-8344/pivota_infra/main.py", line 341, in startup
    raise RuntimeError(f"Database initialization failed: {e}") from e
RuntimeError: Database initialization failed: local variable 'metadata' referenced before assignment

ERROR:    Application startup failed. Exiting.
